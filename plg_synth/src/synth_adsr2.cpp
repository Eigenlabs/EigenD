
/*
 Copyright 2009 Eigenlabs Ltd.  http://www.eigenlabs.com

 This file is part of EigenD.

 EigenD is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 EigenD is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with EigenD.  If not, see <http://www.gnu.org/licenses/>.
*/

#include <piw/piw_clock.h>
#include <piw/piw_cfilter.h>
#include <piw/piw_address.h>
#include <picross/pic_log.h>
#include <picross/pic_float.h>
#include <math.h>

#define MIN_RELEASE 5
#define FULL_RELEASE_TCS 5

#include "synth.h"

#define IN_VELOCITY 1
#define IN_DELAY 2
#define IN_ATTACK 3
#define IN_HOLD 4
#define IN_DECAY 5
#define IN_SUSTAIN 6
#define IN_RELEASE 7
#define IN_PRESSURE 9
#define IN_ATTEN 10
#define IN_AFTERTOUCH 11
#define IN_PEDAL 12
#define IN_ACTIVATION 13
#define IN_DAMPER 14

#define IN_MASK SIG13(IN_VELOCITY,IN_DELAY,IN_ATTACK,IN_HOLD,IN_DECAY,IN_SUSTAIN,IN_RELEASE,IN_PRESSURE,IN_ATTEN,IN_AFTERTOUCH,IN_PEDAL,IN_ACTIVATION,IN_DAMPER)

#define OUT_AMPLITUDE 1
#define OUT_ACTIVATION 2
#define OUT_MASK SIG2(OUT_AMPLITUDE,OUT_ACTIVATION)

#define THRU_MASK SIG1(8)

#define DEFAULT_DELAY_TIME 0
#define DEFAULT_ATTACK_TIME 10
#define DEFAULT_HOLD_TIME 0
#define DEFAULT_DECAY_TIME 50
#define DEFAULT_SUSTAIN 1.0
#define DEFAULT_ATTEN 0.0
#define DEFAULT_RELEASE_TIME 100

#define P_DELAY 0U
#define P_ATTACK 1U
#define P_HOLD 2U
#define P_DECAY 3U
#define P_SUSTAIN 4U
#define P_RELEASE 5U
#define P_OFF 6U
#define P_NUM 7U

#define AMPLITUDE_RANGE_CB 1440.0f // in "centibels", 1/10dB
#define AMPLITUDE_TABLE_SIZE 1441

#define VEL2AMP_RANGE 4095.0f
#define VEL2AMP_TABLE_SIZE 4096

#define OFF_THRESHOLD 0.001

static PIC_FASTCODE const float fadecurve__[128] = {
1.0000000000, 0.9998470286, 0.9993882081, 0.9986238192, 
0.9975543296, 0.9961803937, 0.9945028522, 0.9925227317, 
0.9902412436, 0.9876597840, 0.9847799324, 0.9816034510, 
0.9781322835, 0.9743685538, 0.9703145648, 0.9659727972, 
0.9613459075, 0.9564367270, 0.9512482595, 0.9457836798, 
0.9400463314, 0.9340397251, 0.9277675362, 0.9212336025, 
0.9144419221, 0.9073966507, 0.9001020992, 0.8925627311, 
0.8847831595, 0.8767681446, 0.8685225908, 0.8600515434, 
0.8513601856, 0.8424538357, 0.8333379432, 0.8240180861, 
0.8144999669, 0.8047894099, 0.7948923566, 0.7848148629, 
0.7745630952, 0.7641433263, 0.7535619319, 0.7428253867, 
0.7319402601, 0.7209132127, 0.7097509916, 0.6984604270, 
0.6870484273, 0.6755219754, 0.6638881241, 0.6521539921, 
0.6403267593, 0.6284136625, 0.6164219913, 0.6043590832, 
0.5922323192, 0.5800491196, 0.5678169392, 0.5555432625, 
0.5432355997, 0.5309014817, 0.5185484555, 0.5061840798, 
0.4938159202, 0.4814515445, 0.4690985183, 0.4567644003, 
0.4444567375, 0.4321830608, 0.4199508804, 0.4077676808, 
0.3956409168, 0.3835780087, 0.3715863375, 0.3596732407, 
0.3478460079, 0.3361118759, 0.3244780246, 0.3129515727, 
0.3015395730, 0.2902490084, 0.2790867873, 0.2680597399, 
0.2571746133, 0.2464380681, 0.2358566737, 0.2254369048, 
0.2151851371, 0.2051076434, 0.1952105901, 0.1855000331, 
0.1759819139, 0.1666620568, 0.1575461643, 0.1486398144, 
0.1399484566, 0.1314774092, 0.1232318554, 0.1152168405, 
0.1074372689, 0.0998979008, 0.0926033493, 0.0855580779, 
0.0787663975, 0.0722324638, 0.0659602749, 0.0599536686, 
0.0542163202, 0.0487517405, 0.0435632730, 0.0386540925, 
0.0340272028, 0.0296854352, 0.0256314462, 0.0218677165, 
0.0183965490, 0.0152200676, 0.0123402160, 0.0097587564, 
0.0074772683, 0.0054971478, 0.0038196063, 0.0024456704, 
0.0013761808, 0.0006117919, 0.0001529714, 0.0000000000, 
};

static PIC_FASTCODE const float val2amp_table__[AMPLITUDE_TABLE_SIZE] = { 
0.0000000631, 0.0000000638, 0.0000000646, 0.0000000653, 0.0000000661, 0.0000000668, 0.0000000676, 0.0000000684, 
0.0000000692, 0.0000000700, 0.0000000708, 0.0000000716, 0.0000000724, 0.0000000733, 0.0000000741, 0.0000000750, 
0.0000000759, 0.0000000767, 0.0000000776, 0.0000000785, 0.0000000794, 0.0000000804, 0.0000000813, 0.0000000822, 
0.0000000832, 0.0000000841, 0.0000000851, 0.0000000861, 0.0000000871, 0.0000000881, 0.0000000891, 0.0000000902, 
0.0000000912, 0.0000000923, 0.0000000933, 0.0000000944, 0.0000000955, 0.0000000966, 0.0000000977, 0.0000000989, 
0.0000001000, 0.0000001012, 0.0000001023, 0.0000001035, 0.0000001047, 0.0000001059, 0.0000001072, 0.0000001084, 
0.0000001096, 0.0000001109, 0.0000001122, 0.0000001135, 0.0000001148, 0.0000001161, 0.0000001175, 0.0000001189, 
0.0000001202, 0.0000001216, 0.0000001230, 0.0000001245, 0.0000001259, 0.0000001274, 0.0000001288, 0.0000001303, 
0.0000001318, 0.0000001334, 0.0000001349, 0.0000001365, 0.0000001380, 0.0000001396, 0.0000001413, 0.0000001429, 
0.0000001445, 0.0000001462, 0.0000001479, 0.0000001496, 0.0000001514, 0.0000001531, 0.0000001549, 0.0000001567, 
0.0000001585, 0.0000001603, 0.0000001622, 0.0000001641, 0.0000001660, 0.0000001679, 0.0000001698, 0.0000001718, 
0.0000001738, 0.0000001758, 0.0000001778, 0.0000001799, 0.0000001820, 0.0000001841, 0.0000001862, 0.0000001884, 
0.0000001905, 0.0000001928, 0.0000001950, 0.0000001972, 0.0000001995, 0.0000002018, 0.0000002042, 0.0000002065, 
0.0000002089, 0.0000002113, 0.0000002138, 0.0000002163, 0.0000002188, 0.0000002213, 0.0000002239, 0.0000002265, 
0.0000002291, 0.0000002317, 0.0000002344, 0.0000002371, 0.0000002399, 0.0000002427, 0.0000002455, 0.0000002483, 
0.0000002512, 0.0000002541, 0.0000002570, 0.0000002600, 0.0000002630, 0.0000002661, 0.0000002692, 0.0000002723, 
0.0000002754, 0.0000002786, 0.0000002818, 0.0000002851, 0.0000002884, 0.0000002917, 0.0000002951, 0.0000002985, 
0.0000003020, 0.0000003055, 0.0000003090, 0.0000003126, 0.0000003162, 0.0000003199, 0.0000003236, 0.0000003273, 
0.0000003311, 0.0000003350, 0.0000003388, 0.0000003428, 0.0000003467, 0.0000003508, 0.0000003548, 0.0000003589, 
0.0000003631, 0.0000003673, 0.0000003715, 0.0000003758, 0.0000003802, 0.0000003846, 0.0000003890, 0.0000003936, 
0.0000003981, 0.0000004027, 0.0000004074, 0.0000004121, 0.0000004169, 0.0000004217, 0.0000004266, 0.0000004315, 
0.0000004365, 0.0000004416, 0.0000004467, 0.0000004519, 0.0000004571, 0.0000004624, 0.0000004677, 0.0000004732, 
0.0000004786, 0.0000004842, 0.0000004898, 0.0000004955, 0.0000005012, 0.0000005070, 0.0000005129, 0.0000005188, 
0.0000005248, 0.0000005309, 0.0000005370, 0.0000005433, 0.0000005495, 0.0000005559, 0.0000005623, 0.0000005689, 
0.0000005754, 0.0000005821, 0.0000005888, 0.0000005957, 0.0000006026, 0.0000006095, 0.0000006166, 0.0000006237, 
0.0000006310, 0.0000006383, 0.0000006457, 0.0000006531, 0.0000006607, 0.0000006683, 0.0000006761, 0.0000006839, 
0.0000006918, 0.0000006998, 0.0000007079, 0.0000007161, 0.0000007244, 0.0000007328, 0.0000007413, 0.0000007499, 
0.0000007586, 0.0000007674, 0.0000007762, 0.0000007852, 0.0000007943, 0.0000008035, 0.0000008128, 0.0000008222, 
0.0000008318, 0.0000008414, 0.0000008511, 0.0000008610, 0.0000008710, 0.0000008810, 0.0000008913, 0.0000009016, 
0.0000009120, 0.0000009226, 0.0000009333, 0.0000009441, 0.0000009550, 0.0000009661, 0.0000009772, 0.0000009886, 
0.0000010000, 0.0000010116, 0.0000010233, 0.0000010351, 0.0000010471, 0.0000010593, 0.0000010715, 0.0000010839, 
0.0000010965, 0.0000011092, 0.0000011220, 0.0000011350, 0.0000011482, 0.0000011614, 0.0000011749, 0.0000011885, 
0.0000012023, 0.0000012162, 0.0000012303, 0.0000012445, 0.0000012589, 0.0000012735, 0.0000012882, 0.0000013032, 
0.0000013183, 0.0000013335, 0.0000013490, 0.0000013646, 0.0000013804, 0.0000013964, 0.0000014125, 0.0000014289, 
0.0000014454, 0.0000014622, 0.0000014791, 0.0000014962, 0.0000015136, 0.0000015311, 0.0000015488, 0.0000015668, 
0.0000015849, 0.0000016032, 0.0000016218, 0.0000016406, 0.0000016596, 0.0000016788, 0.0000016982, 0.0000017179, 
0.0000017378, 0.0000017579, 0.0000017783, 0.0000017989, 0.0000018197, 0.0000018408, 0.0000018621, 0.0000018836, 
0.0000019055, 0.0000019275, 0.0000019498, 0.0000019724, 0.0000019953, 0.0000020184, 0.0000020417, 0.0000020654, 
0.0000020893, 0.0000021135, 0.0000021380, 0.0000021627, 0.0000021878, 0.0000022131, 0.0000022387, 0.0000022646, 
0.0000022909, 0.0000023174, 0.0000023442, 0.0000023714, 0.0000023988, 0.0000024266, 0.0000024547, 0.0000024831, 
0.0000025119, 0.0000025410, 0.0000025704, 0.0000026002, 0.0000026303, 0.0000026607, 0.0000026915, 0.0000027227, 
0.0000027542, 0.0000027861, 0.0000028184, 0.0000028510, 0.0000028840, 0.0000029174, 0.0000029512, 0.0000029854, 
0.0000030200, 0.0000030549, 0.0000030903, 0.0000031261, 0.0000031623, 0.0000031989, 0.0000032359, 0.0000032734, 
0.0000033113, 0.0000033497, 0.0000033884, 0.0000034277, 0.0000034674, 0.0000035075, 0.0000035481, 0.0000035892, 
0.0000036308, 0.0000036728, 0.0000037154, 0.0000037584, 0.0000038019, 0.0000038459, 0.0000038905, 0.0000039355, 
0.0000039811, 0.0000040272, 0.0000040738, 0.0000041210, 0.0000041687, 0.0000042170, 0.0000042658, 0.0000043152, 
0.0000043652, 0.0000044157, 0.0000044668, 0.0000045186, 0.0000045709, 0.0000046238, 0.0000046774, 0.0000047315, 
0.0000047863, 0.0000048417, 0.0000048978, 0.0000049545, 0.0000050119, 0.0000050699, 0.0000051286, 0.0000051880, 
0.0000052481, 0.0000053088, 0.0000053703, 0.0000054325, 0.0000054954, 0.0000055590, 0.0000056234, 0.0000056885, 
0.0000057544, 0.0000058210, 0.0000058884, 0.0000059566, 0.0000060256, 0.0000060954, 0.0000061660, 0.0000062373, 
0.0000063096, 0.0000063826, 0.0000064565, 0.0000065313, 0.0000066069, 0.0000066834, 0.0000067608, 0.0000068391, 
0.0000069183, 0.0000069984, 0.0000070795, 0.0000071614, 0.0000072444, 0.0000073282, 0.0000074131, 0.0000074989, 
0.0000075858, 0.0000076736, 0.0000077625, 0.0000078524, 0.0000079433, 0.0000080353, 0.0000081283, 0.0000082224, 
0.0000083176, 0.0000084140, 0.0000085114, 0.0000086099, 0.0000087096, 0.0000088105, 0.0000089125, 0.0000090157, 
0.0000091201, 0.0000092257, 0.0000093325, 0.0000094406, 0.0000095499, 0.0000096605, 0.0000097724, 0.0000098855, 
0.0000100000, 0.0000101158, 0.0000102329, 0.0000103514, 0.0000104713, 0.0000105925, 0.0000107152, 0.0000108393, 
0.0000109648, 0.0000110917, 0.0000112202, 0.0000113501, 0.0000114815, 0.0000116145, 0.0000117490, 0.0000118850, 
0.0000120226, 0.0000121619, 0.0000123027, 0.0000124451, 0.0000125893, 0.0000127350, 0.0000128825, 0.0000130317, 
0.0000131826, 0.0000133352, 0.0000134896, 0.0000136458, 0.0000138038, 0.0000139637, 0.0000141254, 0.0000142889, 
0.0000144544, 0.0000146218, 0.0000147911, 0.0000149624, 0.0000151356, 0.0000153109, 0.0000154882, 0.0000156675, 
0.0000158489, 0.0000160325, 0.0000162181, 0.0000164059, 0.0000165959, 0.0000167880, 0.0000169824, 0.0000171791, 
0.0000173780, 0.0000175792, 0.0000177828, 0.0000179887, 0.0000181970, 0.0000184077, 0.0000186209, 0.0000188365, 
0.0000190546, 0.0000192752, 0.0000194984, 0.0000197242, 0.0000199526, 0.0000201837, 0.0000204174, 0.0000206538, 
0.0000208930, 0.0000211349, 0.0000213796, 0.0000216272, 0.0000218776, 0.0000221309, 0.0000223872, 0.0000226464, 
0.0000229087, 0.0000231739, 0.0000234423, 0.0000237137, 0.0000239883, 0.0000242661, 0.0000245471, 0.0000248313, 
0.0000251189, 0.0000254097, 0.0000257040, 0.0000260016, 0.0000263027, 0.0000266073, 0.0000269153, 0.0000272270, 
0.0000275423, 0.0000278612, 0.0000281838, 0.0000285102, 0.0000288403, 0.0000291743, 0.0000295121, 0.0000298538, 
0.0000301995, 0.0000305492, 0.0000309030, 0.0000312608, 0.0000316228, 0.0000319890, 0.0000323594, 0.0000327341, 
0.0000331131, 0.0000334965, 0.0000338844, 0.0000342768, 0.0000346737, 0.0000350752, 0.0000354813, 0.0000358922, 
0.0000363078, 0.0000367282, 0.0000371535, 0.0000375837, 0.0000380189, 0.0000384592, 0.0000389045, 0.0000393550, 
0.0000398107, 0.0000402717, 0.0000407380, 0.0000412098, 0.0000416869, 0.0000421697, 0.0000426580, 0.0000431519, 
0.0000436516, 0.0000441570, 0.0000446684, 0.0000451856, 0.0000457088, 0.0000462381, 0.0000467735, 0.0000473151, 
0.0000478630, 0.0000484172, 0.0000489779, 0.0000495450, 0.0000501187, 0.0000506991, 0.0000512861, 0.0000518800, 
0.0000524807, 0.0000530884, 0.0000537032, 0.0000543250, 0.0000549541, 0.0000555904, 0.0000562341, 0.0000568853, 
0.0000575440, 0.0000582103, 0.0000588844, 0.0000595662, 0.0000602560, 0.0000609537, 0.0000616595, 0.0000623735, 
0.0000630957, 0.0000638263, 0.0000645654, 0.0000653131, 0.0000660693, 0.0000668344, 0.0000676083, 0.0000683912, 
0.0000691831, 0.0000699842, 0.0000707946, 0.0000716143, 0.0000724436, 0.0000732825, 0.0000741310, 0.0000749894, 
0.0000758578, 0.0000767361, 0.0000776247, 0.0000785236, 0.0000794328, 0.0000803526, 0.0000812831, 0.0000822243, 
0.0000831764, 0.0000841395, 0.0000851138, 0.0000860994, 0.0000870964, 0.0000881049, 0.0000891251, 0.0000901571, 
0.0000912011, 0.0000922571, 0.0000933254, 0.0000944061, 0.0000954993, 0.0000966051, 0.0000977237, 0.0000988553, 
0.0001000000, 0.0001011579, 0.0001023293, 0.0001035142, 0.0001047129, 0.0001059254, 0.0001071519, 0.0001083927, 
0.0001096478, 0.0001109175, 0.0001122018, 0.0001135011, 0.0001148154, 0.0001161449, 0.0001174898, 0.0001188502, 
0.0001202264, 0.0001216186, 0.0001230269, 0.0001244515, 0.0001258925, 0.0001273503, 0.0001288250, 0.0001303167, 
0.0001318257, 0.0001333521, 0.0001348963, 0.0001364583, 0.0001380384, 0.0001396368, 0.0001412538, 0.0001428894, 
0.0001445440, 0.0001462177, 0.0001479108, 0.0001496236, 0.0001513561, 0.0001531087, 0.0001548817, 0.0001566751, 
0.0001584893, 0.0001603245, 0.0001621810, 0.0001640590, 0.0001659587, 0.0001678804, 0.0001698244, 0.0001717908, 
0.0001737801, 0.0001757924, 0.0001778279, 0.0001798871, 0.0001819701, 0.0001840772, 0.0001862087, 0.0001883649, 
0.0001905461, 0.0001927525, 0.0001949845, 0.0001972423, 0.0001995262, 0.0002018366, 0.0002041738, 0.0002065380, 
0.0002089296, 0.0002113489, 0.0002137962, 0.0002162719, 0.0002187762, 0.0002213095, 0.0002238721, 0.0002264644, 
0.0002290868, 0.0002317395, 0.0002344229, 0.0002371374, 0.0002398833, 0.0002426610, 0.0002454709, 0.0002483133, 
0.0002511886, 0.0002540973, 0.0002570396, 0.0002600160, 0.0002630268, 0.0002660725, 0.0002691535, 0.0002722701, 
0.0002754229, 0.0002786121, 0.0002818383, 0.0002851018, 0.0002884032, 0.0002917427, 0.0002951209, 0.0002985383, 
0.0003019952, 0.0003054921, 0.0003090295, 0.0003126079, 0.0003162278, 0.0003198895, 0.0003235937, 0.0003273407, 
0.0003311311, 0.0003349654, 0.0003388442, 0.0003427678, 0.0003467369, 0.0003507519, 0.0003548134, 0.0003589219, 
0.0003630781, 0.0003672823, 0.0003715352, 0.0003758374, 0.0003801894, 0.0003845918, 0.0003890451, 0.0003935501, 
0.0003981072, 0.0004027170, 0.0004073803, 0.0004120975, 0.0004168694, 0.0004216965, 0.0004265795, 0.0004315191, 
0.0004365158, 0.0004415704, 0.0004466836, 0.0004518559, 0.0004570882, 0.0004623810, 0.0004677351, 0.0004731513, 
0.0004786301, 0.0004841724, 0.0004897788, 0.0004954502, 0.0005011872, 0.0005069907, 0.0005128614, 0.0005188000, 
0.0005248075, 0.0005308844, 0.0005370318, 0.0005432503, 0.0005495409, 0.0005559043, 0.0005623413, 0.0005688529, 
0.0005754399, 0.0005821032, 0.0005888437, 0.0005956621, 0.0006025596, 0.0006095369, 0.0006165950, 0.0006237348, 
0.0006309573, 0.0006382635, 0.0006456542, 0.0006531306, 0.0006606934, 0.0006683439, 0.0006760830, 0.0006839116, 
0.0006918310, 0.0006998420, 0.0007079458, 0.0007161434, 0.0007244360, 0.0007328245, 0.0007413102, 0.0007498942, 
0.0007585776, 0.0007673615, 0.0007762471, 0.0007852356, 0.0007943282, 0.0008035261, 0.0008128305, 0.0008222426, 
0.0008317638, 0.0008413951, 0.0008511380, 0.0008609938, 0.0008709636, 0.0008810489, 0.0008912509, 0.0009015711, 
0.0009120108, 0.0009225714, 0.0009332543, 0.0009440609, 0.0009549926, 0.0009660509, 0.0009772372, 0.0009885531, 
0.0010000000, 0.0010115795, 0.0010232930, 0.0010351422, 0.0010471285, 0.0010592537, 0.0010715193, 0.0010839269, 
0.0010964782, 0.0011091748, 0.0011220185, 0.0011350108, 0.0011481536, 0.0011614486, 0.0011748976, 0.0011885022, 
0.0012022644, 0.0012161860, 0.0012302688, 0.0012445146, 0.0012589254, 0.0012735031, 0.0012882496, 0.0013031668, 
0.0013182567, 0.0013335214, 0.0013489629, 0.0013645831, 0.0013803843, 0.0013963684, 0.0014125375, 0.0014288940, 
0.0014454398, 0.0014621772, 0.0014791084, 0.0014962357, 0.0015135612, 0.0015310875, 0.0015488166, 0.0015667511, 
0.0015848932, 0.0016032454, 0.0016218101, 0.0016405898, 0.0016595869, 0.0016788040, 0.0016982437, 0.0017179084, 
0.0017378008, 0.0017579236, 0.0017782794, 0.0017988709, 0.0018197009, 0.0018407720, 0.0018620871, 0.0018836491, 
0.0019054607, 0.0019275249, 0.0019498446, 0.0019724227, 0.0019952623, 0.0020183664, 0.0020417379, 0.0020653802, 
0.0020892961, 0.0021134890, 0.0021379621, 0.0021627185, 0.0021877616, 0.0022130947, 0.0022387211, 0.0022646443, 
0.0022908677, 0.0023173946, 0.0023442288, 0.0023713737, 0.0023988329, 0.0024266101, 0.0024547089, 0.0024831331, 
0.0025118864, 0.0025409727, 0.0025703958, 0.0026001596, 0.0026302680, 0.0026607251, 0.0026915348, 0.0027227013, 
0.0027542287, 0.0027861212, 0.0028183829, 0.0028510183, 0.0028840315, 0.0029174270, 0.0029512092, 0.0029853826, 
0.0030199517, 0.0030549211, 0.0030902954, 0.0031260794, 0.0031622777, 0.0031988951, 0.0032359366, 0.0032734069, 
0.0033113112, 0.0033496544, 0.0033884416, 0.0034276779, 0.0034673685, 0.0035075187, 0.0035481339, 0.0035892193, 
0.0036307805, 0.0036728230, 0.0037153523, 0.0037583740, 0.0038018940, 0.0038459178, 0.0038904514, 0.0039355008, 
0.0039810717, 0.0040271703, 0.0040738028, 0.0041209752, 0.0041686938, 0.0042169650, 0.0042657952, 0.0043151908, 
0.0043651583, 0.0044157045, 0.0044668359, 0.0045185594, 0.0045708819, 0.0046238102, 0.0046773514, 0.0047315126, 
0.0047863009, 0.0048417237, 0.0048977882, 0.0049545019, 0.0050118723, 0.0050699071, 0.0051286138, 0.0051880004, 
0.0052480746, 0.0053088444, 0.0053703180, 0.0054325033, 0.0054954087, 0.0055590426, 0.0056234133, 0.0056885293, 
0.0057543994, 0.0058210322, 0.0058884366, 0.0059566214, 0.0060255959, 0.0060953690, 0.0061659500, 0.0062373484, 
0.0063095734, 0.0063826349, 0.0064565423, 0.0065313055, 0.0066069345, 0.0066834392, 0.0067608298, 0.0068391165, 
0.0069183097, 0.0069984200, 0.0070794578, 0.0071614341, 0.0072443596, 0.0073282453, 0.0074131024, 0.0074989421, 
0.0075857758, 0.0076736149, 0.0077624712, 0.0078523563, 0.0079432823, 0.0080352612, 0.0081283052, 0.0082224265, 
0.0083176377, 0.0084139514, 0.0085113804, 0.0086099375, 0.0087096359, 0.0088104887, 0.0089125094, 0.0090157114, 
0.0091201084, 0.0092257143, 0.0093325430, 0.0094406088, 0.0095499259, 0.0096605088, 0.0097723722, 0.0098855309, 
0.0100000000, 0.0101157945, 0.0102329299, 0.0103514217, 0.0104712855, 0.0105925373, 0.0107151931, 0.0108392691, 
0.0109647820, 0.0110917482, 0.0112201845, 0.0113501082, 0.0114815362, 0.0116144861, 0.0117489755, 0.0118850223, 
0.0120226443, 0.0121618600, 0.0123026877, 0.0124451461, 0.0125892541, 0.0127350308, 0.0128824955, 0.0130316678, 
0.0131825674, 0.0133352143, 0.0134896288, 0.0136458314, 0.0138038426, 0.0139636836, 0.0141253754, 0.0142889396, 
0.0144543977, 0.0146217717, 0.0147910839, 0.0149623566, 0.0151356125, 0.0153108746, 0.0154881662, 0.0156675107, 
0.0158489319, 0.0160324539, 0.0162181010, 0.0164058977, 0.0165958691, 0.0167880402, 0.0169824365, 0.0171790839, 
0.0173780083, 0.0175792361, 0.0177827941, 0.0179887092, 0.0181970086, 0.0184077200, 0.0186208714, 0.0188364909, 
0.0190546072, 0.0192752491, 0.0194984460, 0.0197242274, 0.0199526231, 0.0201836636, 0.0204173794, 0.0206538016, 
0.0208929613, 0.0211348904, 0.0213796209, 0.0216271852, 0.0218776162, 0.0221309471, 0.0223872114, 0.0226464431, 
0.0229086765, 0.0231739465, 0.0234422882, 0.0237137371, 0.0239883292, 0.0242661010, 0.0245470892, 0.0248313311, 
0.0251188643, 0.0254097271, 0.0257039578, 0.0260015956, 0.0263026799, 0.0266072506, 0.0269153480, 0.0272270131, 
0.0275422870, 0.0278612117, 0.0281838293, 0.0285101827, 0.0288403150, 0.0291742701, 0.0295120923, 0.0298538262, 
0.0301995172, 0.0305492111, 0.0309029543, 0.0312607937, 0.0316227766, 0.0319889511, 0.0323593657, 0.0327340695, 
0.0331131121, 0.0334965439, 0.0338844156, 0.0342767787, 0.0346736850, 0.0350751874, 0.0354813389, 0.0358921935, 
0.0363078055, 0.0367282300, 0.0371535229, 0.0375837404, 0.0380189396, 0.0384591782, 0.0389045145, 0.0393550075, 
0.0398107171, 0.0402717034, 0.0407380278, 0.0412097519, 0.0416869383, 0.0421696503, 0.0426579519, 0.0431519077, 
0.0436515832, 0.0441570447, 0.0446683592, 0.0451855944, 0.0457088190, 0.0462381021, 0.0467735141, 0.0473151259, 
0.0478630092, 0.0484172368, 0.0489778819, 0.0495450191, 0.0501187234, 0.0506990708, 0.0512861384, 0.0518800039, 
0.0524807460, 0.0530884444, 0.0537031796, 0.0543250331, 0.0549540874, 0.0555904257, 0.0562341325, 0.0568852931, 
0.0575439937, 0.0582103218, 0.0588843655, 0.0595662144, 0.0602559586, 0.0609536897, 0.0616595002, 0.0623734835, 
0.0630957344, 0.0638263486, 0.0645654229, 0.0653130553, 0.0660693448, 0.0668343918, 0.0676082975, 0.0683911647, 
0.0691830971, 0.0699841996, 0.0707945784, 0.0716143410, 0.0724435960, 0.0732824533, 0.0741310241, 0.0749894209, 
0.0758577575, 0.0767361489, 0.0776247117, 0.0785235635, 0.0794328235, 0.0803526122, 0.0812830516, 0.0822242650, 
0.0831763771, 0.0841395142, 0.0851138038, 0.0860993752, 0.0870963590, 0.0881048873, 0.0891250938, 0.0901571138, 
0.0912010839, 0.0922571427, 0.0933254301, 0.0944060876, 0.0954992586, 0.0966050879, 0.0977237221, 0.0988553095, 
0.1000000000, 0.1011579454, 0.1023292992, 0.1035142167, 0.1047128548, 0.1059253725, 0.1071519305, 0.1083926914, 
0.1096478196, 0.1109174815, 0.1122018454, 0.1135010816, 0.1148153621, 0.1161448614, 0.1174897555, 0.1188502227, 
0.1202264435, 0.1216186001, 0.1230268771, 0.1244514612, 0.1258925412, 0.1273503081, 0.1288249552, 0.1303166778, 
0.1318256739, 0.1333521432, 0.1348962883, 0.1364583137, 0.1380384265, 0.1396368361, 0.1412537545, 0.1428893959, 
0.1445439771, 0.1462177174, 0.1479108388, 0.1496235656, 0.1513561248, 0.1531087462, 0.1548816619, 0.1566751070, 
0.1584893192, 0.1603245391, 0.1621810097, 0.1640589773, 0.1659586907, 0.1678804018, 0.1698243652, 0.1717908387, 
0.1737800829, 0.1757923614, 0.1778279410, 0.1798870915, 0.1819700859, 0.1840772001, 0.1862087137, 0.1883649089, 
0.1905460718, 0.1927524913, 0.1949844600, 0.1972422736, 0.1995262315, 0.2018366364, 0.2041737945, 0.2065380156, 
0.2089296131, 0.2113489040, 0.2137962090, 0.2162718524, 0.2187761624, 0.2213094710, 0.2238721139, 0.2264644308, 
0.2290867653, 0.2317394650, 0.2344228815, 0.2371373706, 0.2398832919, 0.2426610095, 0.2454708916, 0.2483133105, 
0.2511886432, 0.2540972706, 0.2570395783, 0.2600159563, 0.2630267992, 0.2660725060, 0.2691534804, 0.2722701308, 
0.2754228703, 0.2786121169, 0.2818382931, 0.2851018268, 0.2884031503, 0.2917427014, 0.2951209227, 0.2985382619, 
0.3019951720, 0.3054921113, 0.3090295433, 0.3126079367, 0.3162277660, 0.3198895110, 0.3235936569, 0.3273406949, 
0.3311311215, 0.3349654392, 0.3388441561, 0.3427677865, 0.3467368505, 0.3507518740, 0.3548133892, 0.3589219346, 
0.3630780548, 0.3672823005, 0.3715352291, 0.3758374043, 0.3801893963, 0.3845917820, 0.3890451450, 0.3935500755, 
0.3981071706, 0.4027170343, 0.4073802778, 0.4120975191, 0.4168693835, 0.4216965034, 0.4265795188, 0.4315190768, 
0.4365158322, 0.4415704474, 0.4466835922, 0.4518559444, 0.4570881896, 0.4623810214, 0.4677351413, 0.4731512590, 
0.4786300923, 0.4841723676, 0.4897788194, 0.4954501908, 0.5011872336, 0.5069907083, 0.5128613840, 0.5188000389, 
0.5248074602, 0.5308844442, 0.5370317964, 0.5432503315, 0.5495408739, 0.5559042573, 0.5623413252, 0.5688529308, 
0.5754399373, 0.5821032178, 0.5888436554, 0.5956621435, 0.6025595861, 0.6095368972, 0.6165950019, 0.6237348355, 
0.6309573445, 0.6382634862, 0.6456542290, 0.6531305526, 0.6606934480, 0.6683439176, 0.6760829754, 0.6839116473, 
0.6918309709, 0.6998419960, 0.7079457844, 0.7161434102, 0.7244359601, 0.7328245331, 0.7413102413, 0.7498942093, 
0.7585775750, 0.7673614894, 0.7762471166, 0.7852356346, 0.7943282347, 0.8035261222, 0.8128305162, 0.8222426499, 
0.8317637711, 0.8413951416, 0.8511380382, 0.8609937522, 0.8709635900, 0.8810488730, 0.8912509381, 0.9015711376, 
0.9120108394, 0.9225714272, 0.9332543008, 0.9440608763, 0.9549925860, 0.9660508790, 0.9772372210, 0.9885530947, 
1.0000000000, };

static PIC_FASTCODE const float vel2amp_table__[VEL2AMP_TABLE_SIZE] = { 
0.0000000000, 0.0000441841, 0.0000883790, 0.0001325847, 0.0001768012, 0.0002210285, 0.0002652667, 0.0003095156, 
0.0003537754, 0.0003980459, 0.0004423274, 0.0004866196, 0.0005309227, 0.0005752367, 0.0006195615, 0.0006638972, 
0.0007082437, 0.0007526011, 0.0007969694, 0.0008413485, 0.0008857386, 0.0009301395, 0.0009745514, 0.0010189741, 
0.0010634078, 0.0011078523, 0.0011523078, 0.0011967742, 0.0012412515, 0.0012857398, 0.0013302390, 0.0013747492, 
0.0014192703, 0.0014638024, 0.0015083454, 0.0015528994, 0.0015974643, 0.0016420403, 0.0016866272, 0.0017312251, 
0.0017758340, 0.0018204539, 0.0018650848, 0.0019097268, 0.0019543797, 0.0019990437, 0.0020437186, 0.0020884047, 
0.0021331017, 0.0021778098, 0.0022225290, 0.0022672592, 0.0023120004, 0.0023567528, 0.0024015162, 0.0024462906, 
0.0024910762, 0.0025358728, 0.0025806806, 0.0026254994, 0.0026703293, 0.0027151704, 0.0027600225, 0.0028048858, 
0.0028497602, 0.0028946458, 0.0029395424, 0.0029844502, 0.0030293692, 0.0030742993, 0.0031192406, 0.0031641930, 
0.0032091566, 0.0032541314, 0.0032991174, 0.0033441145, 0.0033891229, 0.0034341424, 0.0034791731, 0.0035242151, 
0.0035692683, 0.0036143326, 0.0036594083, 0.0037044951, 0.0037495932, 0.0037947025, 0.0038398231, 0.0038849549, 
0.0039300980, 0.0039752523, 0.0040204179, 0.0040655948, 0.0041107830, 0.0041559824, 0.0042011932, 0.0042464152, 
0.0042916486, 0.0043368933, 0.0043821492, 0.0044274165, 0.0044726952, 0.0045179851, 0.0045632864, 0.0046085991, 
0.0046539231, 0.0046992584, 0.0047446051, 0.0047899632, 0.0048353326, 0.0048807135, 0.0049261057, 0.0049715093, 
0.0050169243, 0.0050623506, 0.0051077884, 0.0051532377, 0.0051986983, 0.0052441703, 0.0052896538, 0.0053351487, 
0.0053806551, 0.0054261729, 0.0054717022, 0.0055172429, 0.0055627951, 0.0056083587, 0.0056539338, 0.0056995204, 
0.0057451185, 0.0057907281, 0.0058363492, 0.0058819818, 0.0059276259, 0.0059732815, 0.0060189487, 0.0060646273, 
0.0061103175, 0.0061560193, 0.0062017325, 0.0062474574, 0.0062931938, 0.0063389417, 0.0063847012, 0.0064304723, 
0.0064762550, 0.0065220493, 0.0065678551, 0.0066136726, 0.0066595017, 0.0067053423, 0.0067511946, 0.0067970585, 
0.0068429340, 0.0068888212, 0.0069347200, 0.0069806305, 0.0070265526, 0.0070724863, 0.0071184317, 0.0071643888, 
0.0072103576, 0.0072563380, 0.0073023302, 0.0073483340, 0.0073943495, 0.0074403767, 0.0074864157, 0.0075324663, 
0.0075785287, 0.0076246028, 0.0076706886, 0.0077167862, 0.0077628955, 0.0078090166, 0.0078551494, 0.0079012940, 
0.0079474504, 0.0079936185, 0.0080397985, 0.0080859902, 0.0081321937, 0.0081784090, 0.0082246361, 0.0082708750, 
0.0083171258, 0.0083633883, 0.0084096627, 0.0084559490, 0.0085022471, 0.0085485570, 0.0085948788, 0.0086412124, 
0.0086875579, 0.0087339153, 0.0087802845, 0.0088266657, 0.0088730587, 0.0089194637, 0.0089658805, 0.0090123092, 
0.0090587499, 0.0091052025, 0.0091516670, 0.0091981434, 0.0092446318, 0.0092911322, 0.0093376444, 0.0093841687, 
0.0094307049, 0.0094772531, 0.0095238132, 0.0095703853, 0.0096169695, 0.0096635656, 0.0097101737, 0.0097567938, 
0.0098034260, 0.0098500702, 0.0098967263, 0.0099433946, 0.0099900748, 0.0100367671, 0.0100834715, 0.0101301879, 
0.0101769164, 0.0102236569, 0.0102704096, 0.0103171743, 0.0103639511, 0.0104107400, 0.0104575409, 0.0105043540, 
0.0105511793, 0.0105980166, 0.0106448661, 0.0106917276, 0.0107386014, 0.0107854872, 0.0108323853, 0.0108792955, 
0.0109262178, 0.0109731523, 0.0110200990, 0.0110670579, 0.0111140290, 0.0111610122, 0.0112080077, 0.0112550154, 
0.0113020353, 0.0113490674, 0.0113961117, 0.0114431683, 0.0114902371, 0.0115373181, 0.0115844114, 0.0116315170, 
0.0116786348, 0.0117257649, 0.0117729073, 0.0118200620, 0.0118672289, 0.0119144082, 0.0119615998, 0.0120088036, 
0.0120560198, 0.0121032483, 0.0121504892, 0.0121977423, 0.0122450079, 0.0122922857, 0.0123395759, 0.0123868785, 
0.0124341935, 0.0124815208, 0.0125288605, 0.0125762126, 0.0126235771, 0.0126709540, 0.0127183433, 0.0127657450, 
0.0128131591, 0.0128605857, 0.0129080247, 0.0129554761, 0.0130029400, 0.0130504163, 0.0130979051, 0.0131454064, 
0.0131929201, 0.0132404463, 0.0132879850, 0.0133355362, 0.0133830999, 0.0134306761, 0.0134782648, 0.0135258660, 
0.0135734797, 0.0136211060, 0.0136687448, 0.0137163962, 0.0137640601, 0.0138117366, 0.0138594256, 0.0139071272, 
0.0139548414, 0.0140025681, 0.0140503075, 0.0140980595, 0.0141458240, 0.0141936012, 0.0142413910, 0.0142891934, 
0.0143370084, 0.0143848361, 0.0144326764, 0.0144805294, 0.0145283951, 0.0145762734, 0.0146241643, 0.0146720680, 
0.0147199843, 0.0147679133, 0.0148158551, 0.0148638095, 0.0149117766, 0.0149597565, 0.0150077491, 0.0150557544, 
0.0151037724, 0.0151518032, 0.0151998468, 0.0152479031, 0.0152959722, 0.0153440540, 0.0153921486, 0.0154402561, 
0.0154883763, 0.0155365093, 0.0155846551, 0.0156328137, 0.0156809852, 0.0157291694, 0.0157773665, 0.0158255765, 
0.0158737993, 0.0159220349, 0.0159702834, 0.0160185448, 0.0160668191, 0.0161151062, 0.0161634062, 0.0162117191, 
0.0162600450, 0.0163083837, 0.0163567353, 0.0164050999, 0.0164534774, 0.0165018678, 0.0165502712, 0.0165986875, 
0.0166471168, 0.0166955591, 0.0167440143, 0.0167924825, 0.0168409637, 0.0168894579, 0.0169379651, 0.0169864853, 
0.0170350185, 0.0170835647, 0.0171321239, 0.0171806962, 0.0172292815, 0.0172778799, 0.0173264913, 0.0173751158, 
0.0174237534, 0.0174724040, 0.0175210677, 0.0175697445, 0.0176184344, 0.0176671374, 0.0177158536, 0.0177645828, 
0.0178133252, 0.0178620807, 0.0179108493, 0.0179596311, 0.0180084260, 0.0180572341, 0.0181060554, 0.0181548899, 
0.0182037375, 0.0182525983, 0.0183014723, 0.0183503595, 0.0183992600, 0.0184481736, 0.0184971005, 0.0185460406, 
0.0185949939, 0.0186439605, 0.0186929404, 0.0187419335, 0.0187909398, 0.0188399595, 0.0188889924, 0.0189380386, 
0.0189870982, 0.0190361710, 0.0190852571, 0.0191343566, 0.0191834694, 0.0192325955, 0.0192817349, 0.0193308877, 
0.0193800539, 0.0194292334, 0.0194784263, 0.0195276325, 0.0195768522, 0.0196260852, 0.0196753317, 0.0197245915, 
0.0197738648, 0.0198231514, 0.0198724515, 0.0199217651, 0.0199710921, 0.0200204325, 0.0200697864, 0.0201191537, 
0.0201685346, 0.0202179289, 0.0202673367, 0.0203167580, 0.0203661927, 0.0204156410, 0.0204651028, 0.0205145782, 
0.0205640670, 0.0206135694, 0.0206630854, 0.0207126149, 0.0207621580, 0.0208117146, 0.0208612848, 0.0209108686, 
0.0209604660, 0.0210100769, 0.0210597015, 0.0211093397, 0.0211589915, 0.0212086570, 0.0212583360, 0.0213080288, 
0.0213577351, 0.0214074552, 0.0214571889, 0.0215069362, 0.0215566973, 0.0216064720, 0.0216562604, 0.0217060625, 
0.0217558784, 0.0218057079, 0.0218555512, 0.0219054082, 0.0219552790, 0.0220051635, 0.0220550618, 0.0221049738, 
0.0221548996, 0.0222048391, 0.0222547925, 0.0223047596, 0.0223547406, 0.0224047354, 0.0224547439, 0.0225047663, 
0.0225548026, 0.0226048526, 0.0226549166, 0.0227049943, 0.0227550860, 0.0228051915, 0.0228553109, 0.0229054441, 
0.0229555913, 0.0230057524, 0.0230559273, 0.0231061162, 0.0231563190, 0.0232065358, 0.0232567665, 0.0233070111, 
0.0233572697, 0.0234075422, 0.0234578287, 0.0235081292, 0.0235584437, 0.0236087722, 0.0236591147, 0.0237094712, 
0.0237598417, 0.0238102262, 0.0238606247, 0.0239110373, 0.0239614640, 0.0240119047, 0.0240623595, 0.0241128283, 
0.0241633112, 0.0242138083, 0.0242643194, 0.0243148446, 0.0243653839, 0.0244159373, 0.0244665049, 0.0245170866, 
0.0245676824, 0.0246182924, 0.0246689166, 0.0247195549, 0.0247702074, 0.0248208741, 0.0248715549, 0.0249222500, 
0.0249729593, 0.0250236828, 0.0250744205, 0.0251251724, 0.0251759386, 0.0252267190, 0.0252775137, 0.0253283226, 
0.0253791458, 0.0254299833, 0.0254808351, 0.0255317012, 0.0255825815, 0.0256334762, 0.0256843852, 0.0257353085, 
0.0257862462, 0.0258371982, 0.0258881645, 0.0259391453, 0.0259901403, 0.0260411498, 0.0260921736, 0.0261432119, 
0.0261942645, 0.0262453315, 0.0262964130, 0.0263475088, 0.0263986191, 0.0264497439, 0.0265008831, 0.0265520367, 
0.0266032048, 0.0266543874, 0.0267055845, 0.0267567961, 0.0268080221, 0.0268592627, 0.0269105177, 0.0269617873, 
0.0270130715, 0.0270643701, 0.0271156833, 0.0271670111, 0.0272183534, 0.0272697103, 0.0273210818, 0.0273724679, 
0.0274238685, 0.0274752838, 0.0275267137, 0.0275781582, 0.0276296173, 0.0276810911, 0.0277325795, 0.0277840826, 
0.0278356003, 0.0278871327, 0.0279386798, 0.0279902416, 0.0280418180, 0.0280934092, 0.0281450151, 0.0281966357, 
0.0282482710, 0.0282999211, 0.0283515859, 0.0284032655, 0.0284549598, 0.0285066690, 0.0285583928, 0.0286101315, 
0.0286618850, 0.0287136533, 0.0287654364, 0.0288172343, 0.0288690471, 0.0289208746, 0.0289727171, 0.0290245744, 
0.0290764465, 0.0291283336, 0.0291802355, 0.0292321523, 0.0292840840, 0.0293360306, 0.0293879922, 0.0294399686, 
0.0294919600, 0.0295439663, 0.0295959876, 0.0296480239, 0.0297000751, 0.0297521413, 0.0298042224, 0.0298563186, 
0.0299084298, 0.0299605560, 0.0300126972, 0.0300648534, 0.0301170247, 0.0301692110, 0.0302214123, 0.0302736288, 
0.0303258603, 0.0303781068, 0.0304303685, 0.0304826453, 0.0305349372, 0.0305872441, 0.0306395663, 0.0306919035, 
0.0307442559, 0.0307966234, 0.0308490061, 0.0309014040, 0.0309538171, 0.0310062453, 0.0310586887, 0.0311111473, 
0.0311636212, 0.0312161102, 0.0312686145, 0.0313211341, 0.0313736688, 0.0314262189, 0.0314787842, 0.0315313647, 
0.0315839606, 0.0316365717, 0.0316891982, 0.0317418399, 0.0317944970, 0.0318471694, 0.0318998571, 0.0319525602, 
0.0320052787, 0.0320580125, 0.0321107616, 0.0321635262, 0.0322163061, 0.0322691015, 0.0323219122, 0.0323747384, 
0.0324275800, 0.0324804370, 0.0325333095, 0.0325861974, 0.0326391008, 0.0326920197, 0.0327449540, 0.0327979038, 
0.0328508691, 0.0329038500, 0.0329568463, 0.0330098582, 0.0330628856, 0.0331159286, 0.0331689871, 0.0332220611, 
0.0332751508, 0.0333282560, 0.0333813768, 0.0334345132, 0.0334876652, 0.0335408329, 0.0335940161, 0.0336472150, 
0.0337004296, 0.0337536597, 0.0338069056, 0.0338601671, 0.0339134443, 0.0339667372, 0.0340200458, 0.0340733701, 
0.0341267102, 0.0341800659, 0.0342334374, 0.0342868246, 0.0343402276, 0.0343936464, 0.0344470809, 0.0345005312, 
0.0345539973, 0.0346074792, 0.0346609770, 0.0347144905, 0.0347680199, 0.0348215651, 0.0348751261, 0.0349287031, 
0.0349822958, 0.0350359045, 0.0350895290, 0.0351431695, 0.0351968258, 0.0352504981, 0.0353041863, 0.0353578904, 
0.0354116105, 0.0354653465, 0.0355190985, 0.0355728664, 0.0356266504, 0.0356804503, 0.0357342662, 0.0357880981, 
0.0358419461, 0.0358958101, 0.0359496901, 0.0360035861, 0.0360574983, 0.0361114264, 0.0361653707, 0.0362193311, 
0.0362733075, 0.0363273001, 0.0363813087, 0.0364353335, 0.0364893744, 0.0365434315, 0.0365975047, 0.0366515941, 
0.0367056997, 0.0367598214, 0.0368139593, 0.0368681135, 0.0369222838, 0.0369764704, 0.0370306732, 0.0370848922, 
0.0371391275, 0.0371933790, 0.0372476469, 0.0373019310, 0.0373562313, 0.0374105480, 0.0374648810, 0.0375192303, 
0.0375735960, 0.0376279780, 0.0376823763, 0.0377367910, 0.0377912220, 0.0378456695, 0.0379001333, 0.0379546135, 
0.0380091101, 0.0380636231, 0.0381181526, 0.0381726985, 0.0382272609, 0.0382818397, 0.0383364350, 0.0383910467, 
0.0384456749, 0.0385003197, 0.0385549809, 0.0386096587, 0.0386643530, 0.0387190638, 0.0387737911, 0.0388285351, 
0.0388832955, 0.0389380726, 0.0389928663, 0.0390476765, 0.0391025034, 0.0391573468, 0.0392122069, 0.0392670837, 
0.0393219771, 0.0393768871, 0.0394318138, 0.0394867572, 0.0395417173, 0.0395966940, 0.0396516875, 0.0397066977, 
0.0397617246, 0.0398167683, 0.0398718287, 0.0399269059, 0.0399819998, 0.0400371105, 0.0400922380, 0.0401473823, 
0.0402025434, 0.0402577214, 0.0403129161, 0.0403681277, 0.0404233562, 0.0404786015, 0.0405338637, 0.0405891428, 
0.0406444387, 0.0406997516, 0.0407550814, 0.0408104281, 0.0408657917, 0.0409211723, 0.0409765698, 0.0410319843, 
0.0410874158, 0.0411428642, 0.0411983297, 0.0412538122, 0.0413093116, 0.0413648281, 0.0414203617, 0.0414759123, 
0.0415314799, 0.0415870646, 0.0416426664, 0.0416982853, 0.0417539213, 0.0418095744, 0.0418652446, 0.0419209319, 
0.0419766364, 0.0420323581, 0.0420880969, 0.0421438528, 0.0421996260, 0.0422554164, 0.0423112239, 0.0423670487, 
0.0424228907, 0.0424787500, 0.0425346265, 0.0425905202, 0.0426464313, 0.0427023596, 0.0427583052, 0.0428142681, 
0.0428702483, 0.0429262458, 0.0429822607, 0.0430382929, 0.0430943425, 0.0431504094, 0.0432064937, 0.0432625954, 
0.0433187145, 0.0433748510, 0.0434310050, 0.0434871763, 0.0435433651, 0.0435995714, 0.0436557951, 0.0437120363, 
0.0437682950, 0.0438245711, 0.0438808648, 0.0439371760, 0.0439935047, 0.0440498510, 0.0441062148, 0.0441625962, 
0.0442189951, 0.0442754117, 0.0443318458, 0.0443882975, 0.0444447669, 0.0445012539, 0.0445577585, 0.0446142808, 
0.0446708207, 0.0447273783, 0.0447839536, 0.0448405465, 0.0448971572, 0.0449537856, 0.0450104317, 0.0450670956, 
0.0451237772, 0.0451804766, 0.0452371937, 0.0452939286, 0.0453506814, 0.0454074519, 0.0454642402, 0.0455210464, 
0.0455778704, 0.0456347122, 0.0456915719, 0.0457484495, 0.0458053450, 0.0458622584, 0.0459191896, 0.0459761388, 
0.0460331059, 0.0460900910, 0.0461470940, 0.0462041149, 0.0462611539, 0.0463182108, 0.0463752857, 0.0464323787, 
0.0464894896, 0.0465466186, 0.0466037656, 0.0466609307, 0.0467181138, 0.0467753150, 0.0468325343, 0.0468897717, 
0.0469470272, 0.0470043009, 0.0470615926, 0.0471189025, 0.0471762306, 0.0472335768, 0.0472909412, 0.0473483238, 
0.0474057246, 0.0474631437, 0.0475205809, 0.0475780364, 0.0476355101, 0.0476930021, 0.0477505124, 0.0478080409, 
0.0478655878, 0.0479231529, 0.0479807364, 0.0480383382, 0.0480959583, 0.0481535968, 0.0482112536, 0.0482689289, 
0.0483266225, 0.0483843345, 0.0484420649, 0.0484998138, 0.0485575811, 0.0486153668, 0.0486731710, 0.0487309937, 
0.0487888348, 0.0488466945, 0.0489045726, 0.0489624693, 0.0490203845, 0.0490783182, 0.0491362705, 0.0491942414, 
0.0492522308, 0.0493102388, 0.0493682655, 0.0494263107, 0.0494843746, 0.0495424571, 0.0496005582, 0.0496586780, 
0.0497168165, 0.0497749737, 0.0498331496, 0.0498913441, 0.0499495574, 0.0500077895, 0.0500660402, 0.0501243098, 
0.0501825981, 0.0502409052, 0.0502992310, 0.0503575757, 0.0504159392, 0.0504743216, 0.0505327227, 0.0505911428, 
0.0506495816, 0.0507080394, 0.0507665161, 0.0508250117, 0.0508835261, 0.0509420595, 0.0510006119, 0.0510591832, 
0.0511177735, 0.0511763827, 0.0512350109, 0.0512936582, 0.0513523244, 0.0514110097, 0.0514697140, 0.0515284374, 
0.0515871798, 0.0516459413, 0.0517047219, 0.0517635216, 0.0518223403, 0.0518811783, 0.0519400353, 0.0519989115, 
0.0520578069, 0.0521167215, 0.0521756552, 0.0522346081, 0.0522935803, 0.0523525717, 0.0524115823, 0.0524706121, 
0.0525296613, 0.0525887297, 0.0526478173, 0.0527069243, 0.0527660506, 0.0528251962, 0.0528843612, 0.0529435455, 
0.0530027492, 0.0530619722, 0.0531212147, 0.0531804765, 0.0532397578, 0.0532990585, 0.0533583786, 0.0534177182, 
0.0534770772, 0.0535364557, 0.0535958537, 0.0536552712, 0.0537147083, 0.0537741648, 0.0538336409, 0.0538931366, 
0.0539526518, 0.0540121866, 0.0540717410, 0.0541313150, 0.0541909086, 0.0542505219, 0.0543101548, 0.0543698074, 
0.0544294796, 0.0544891715, 0.0545488831, 0.0546086144, 0.0546683655, 0.0547281363, 0.0547879268, 0.0548477371, 
0.0549075671, 0.0549674170, 0.0550272867, 0.0550871761, 0.0551470854, 0.0552070146, 0.0552669636, 0.0553269324, 
0.0553869212, 0.0554469298, 0.0555069583, 0.0555670068, 0.0556270752, 0.0556871635, 0.0557472718, 0.0558074001, 
0.0558675484, 0.0559277166, 0.0559879049, 0.0560481132, 0.0561083415, 0.0561685899, 0.0562288584, 0.0562891469, 
0.0563494555, 0.0564097843, 0.0564701331, 0.0565305021, 0.0565908912, 0.0566513005, 0.0567117300, 0.0567721796, 
0.0568326495, 0.0568931396, 0.0569536499, 0.0570141804, 0.0570747312, 0.0571353022, 0.0571958936, 0.0572565052, 
0.0573171372, 0.0573777894, 0.0574384620, 0.0574991550, 0.0575598683, 0.0576206020, 0.0576813561, 0.0577421306, 
0.0578029255, 0.0578637408, 0.0579245766, 0.0579854328, 0.0580463095, 0.0581072067, 0.0581681244, 0.0582290627, 
0.0582900214, 0.0583510007, 0.0584120005, 0.0584730209, 0.0585340619, 0.0585951235, 0.0586562057, 0.0587173086, 
0.0587784320, 0.0588395762, 0.0589007410, 0.0589619264, 0.0590231326, 0.0590843595, 0.0591456071, 0.0592068754, 
0.0592681645, 0.0593294744, 0.0593908050, 0.0594521564, 0.0595135287, 0.0595749217, 0.0596363356, 0.0596977704, 
0.0597592260, 0.0598207024, 0.0598821998, 0.0599437181, 0.0600052573, 0.0600668175, 0.0601283985, 0.0601900006, 
0.0602516236, 0.0603132677, 0.0603749327, 0.0604366187, 0.0604983258, 0.0605600540, 0.0606218032, 0.0606835735, 
0.0607453648, 0.0608071773, 0.0608690109, 0.0609308656, 0.0609927415, 0.0610546386, 0.0611165568, 0.0611784962, 
0.0612404569, 0.0613024387, 0.0613644418, 0.0614264662, 0.0614885118, 0.0615505787, 0.0616126669, 0.0616747764, 
0.0617369072, 0.0617990594, 0.0618612329, 0.0619234278, 0.0619856441, 0.0620478817, 0.0621101408, 0.0621724214, 
0.0622347233, 0.0622970467, 0.0623593916, 0.0624217580, 0.0624841459, 0.0625465553, 0.0626089862, 0.0626714387, 
0.0627339127, 0.0627964083, 0.0628589255, 0.0629214643, 0.0629840247, 0.0630466068, 0.0631092105, 0.0631718359, 
0.0632344829, 0.0632971517, 0.0633598422, 0.0634225544, 0.0634852883, 0.0635480440, 0.0636108215, 0.0636736207, 
0.0637364418, 0.0637992846, 0.0638621493, 0.0639250359, 0.0639879443, 0.0640508746, 0.0641138267, 0.0641768008, 
0.0642397968, 0.0643028148, 0.0643658547, 0.0644289166, 0.0644920004, 0.0645551063, 0.0646182341, 0.0646813840, 
0.0647445560, 0.0648077500, 0.0648709661, 0.0649342042, 0.0649974645, 0.0650607469, 0.0651240515, 0.0651873782, 
0.0652507270, 0.0653140981, 0.0653774913, 0.0654409068, 0.0655043445, 0.0655678044, 0.0656312866, 0.0656947911, 
0.0657583179, 0.0658218670, 0.0658854384, 0.0659490322, 0.0660126483, 0.0660762868, 0.0661399477, 0.0662036309, 
0.0662673366, 0.0663310648, 0.0663948154, 0.0664585884, 0.0665223839, 0.0665862020, 0.0666500425, 0.0667139056, 
0.0667777912, 0.0668416994, 0.0669056302, 0.0669695835, 0.0670335595, 0.0670975581, 0.0671615794, 0.0672256233, 
0.0672896898, 0.0673537791, 0.0674178911, 0.0674820258, 0.0675461832, 0.0676103634, 0.0676745663, 0.0677387921, 
0.0678030406, 0.0678673120, 0.0679316062, 0.0679959233, 0.0680602632, 0.0681246260, 0.0681890117, 0.0682534203, 
0.0683178519, 0.0683823064, 0.0684467839, 0.0685112843, 0.0685758078, 0.0686403543, 0.0687049238, 0.0687695163, 
0.0688341319, 0.0688987706, 0.0689634324, 0.0690281173, 0.0690928254, 0.0691575566, 0.0692223109, 0.0692870884, 
0.0693518892, 0.0694167131, 0.0694815603, 0.0695464307, 0.0696113244, 0.0696762414, 0.0697411816, 0.0698061452, 
0.0698711321, 0.0699361423, 0.0700011760, 0.0700662330, 0.0701313134, 0.0701964172, 0.0702615444, 0.0703266951, 
0.0703918692, 0.0704570669, 0.0705222880, 0.0705875327, 0.0706528008, 0.0707180926, 0.0707834079, 0.0708487468, 
0.0709141092, 0.0709794953, 0.0710449051, 0.0711103385, 0.0711757955, 0.0712412763, 0.0713067807, 0.0713723089, 
0.0714378608, 0.0715034365, 0.0715690359, 0.0716346591, 0.0717003061, 0.0717659770, 0.0718316717, 0.0718973902, 
0.0719631327, 0.0720288990, 0.0720946892, 0.0721605034, 0.0722263415, 0.0722922036, 0.0723580896, 0.0724239997, 
0.0724899337, 0.0725558918, 0.0726218740, 0.0726878802, 0.0727539105, 0.0728199649, 0.0728860434, 0.0729521461, 
0.0730182729, 0.0730844239, 0.0731505991, 0.0732167984, 0.0732830221, 0.0733492699, 0.0734155421, 0.0734818385, 
0.0735481592, 0.0736145042, 0.0736808735, 0.0737472672, 0.0738136853, 0.0738801278, 0.0739465946, 0.0740130859, 
0.0740796016, 0.0741461418, 0.0742127065, 0.0742792956, 0.0743459093, 0.0744125475, 0.0744792103, 0.0745458976, 
0.0746126095, 0.0746793460, 0.0747461071, 0.0748128929, 0.0748797033, 0.0749465384, 0.0750133982, 0.0750802827, 
0.0751471920, 0.0752141259, 0.0752810847, 0.0753480682, 0.0754150766, 0.0754821098, 0.0755491678, 0.0756162506, 
0.0756833584, 0.0757504910, 0.0758176486, 0.0758848311, 0.0759520385, 0.0760192709, 0.0760865283, 0.0761538107, 
0.0762211182, 0.0762884506, 0.0763558082, 0.0764231908, 0.0764905985, 0.0765580314, 0.0766254894, 0.0766929725, 
0.0767604808, 0.0768280143, 0.0768955730, 0.0769631570, 0.0770307662, 0.0770984007, 0.0771660604, 0.0772337455, 
0.0773014559, 0.0773691916, 0.0774369528, 0.0775047392, 0.0775725511, 0.0776403884, 0.0777082512, 0.0777761394, 
0.0778440531, 0.0779119923, 0.0779799570, 0.0780479473, 0.0781159631, 0.0781840044, 0.0782520714, 0.0783201640, 
0.0783882822, 0.0784564261, 0.0785245956, 0.0785927908, 0.0786610118, 0.0787292584, 0.0787975308, 0.0788658290, 
0.0789341530, 0.0790025028, 0.0790708784, 0.0791392798, 0.0792077071, 0.0792761603, 0.0793446395, 0.0794131445, 
0.0794816755, 0.0795502324, 0.0796188153, 0.0796874242, 0.0797560592, 0.0798247202, 0.0798934072, 0.0799621204, 
0.0800308596, 0.0800996250, 0.0801684164, 0.0802372341, 0.0803060780, 0.0803749480, 0.0804438443, 0.0805127668, 
0.0805817155, 0.0806506906, 0.0807196919, 0.0807887196, 0.0808577736, 0.0809268540, 0.0809959607, 0.0810650939, 
0.0811342535, 0.0812034395, 0.0812726520, 0.0813418909, 0.0814111564, 0.0814804484, 0.0815497669, 0.0816191120, 
0.0816884837, 0.0817578820, 0.0818273069, 0.0818967585, 0.0819662367, 0.0820357416, 0.0821052732, 0.0821748316, 
0.0822444167, 0.0823140285, 0.0823836672, 0.0824533326, 0.0825230249, 0.0825927441, 0.0826624901, 0.0827322630, 
0.0828020628, 0.0828718896, 0.0829417433, 0.0830116240, 0.0830815317, 0.0831514664, 0.0832214281, 0.0832914169, 
0.0833614328, 0.0834314757, 0.0835015458, 0.0835716431, 0.0836417675, 0.0837119191, 0.0837820979, 0.0838523039, 
0.0839225372, 0.0839927977, 0.0840630856, 0.0841334007, 0.0842037432, 0.0842741131, 0.0843445103, 0.0844149349, 
0.0844853869, 0.0845558664, 0.0846263733, 0.0846969077, 0.0847674696, 0.0848380591, 0.0849086761, 0.0849793206, 
0.0850499928, 0.0851206925, 0.0851914199, 0.0852621750, 0.0853329577, 0.0854037681, 0.0854746063, 0.0855454722, 
0.0856163658, 0.0856872872, 0.0857582365, 0.0858292135, 0.0859002185, 0.0859712513, 0.0860423119, 0.0861134005, 
0.0861845171, 0.0862556616, 0.0863268341, 0.0863980345, 0.0864692631, 0.0865405196, 0.0866118043, 0.0866831170, 
0.0867544578, 0.0868258268, 0.0868972239, 0.0869686492, 0.0870401028, 0.0871115845, 0.0871830945, 0.0872546328, 
0.0873261993, 0.0873977942, 0.0874694174, 0.0875410690, 0.0876127489, 0.0876844573, 0.0877561941, 0.0878279593, 
0.0878997530, 0.0879715752, 0.0880434259, 0.0881153052, 0.0881872130, 0.0882591494, 0.0883311144, 0.0884031081, 
0.0884751304, 0.0885471814, 0.0886192610, 0.0886913694, 0.0887635066, 0.0888356725, 0.0889078672, 0.0889800907, 
0.0890523431, 0.0891246243, 0.0891969344, 0.0892692734, 0.0893416414, 0.0894140383, 0.0894864641, 0.0895589190, 
0.0896314029, 0.0897039158, 0.0897764578, 0.0898490289, 0.0899216292, 0.0899942585, 0.0900669170, 0.0901396047, 
0.0902123216, 0.0902850678, 0.0903578432, 0.0904306479, 0.0905034819, 0.0905763452, 0.0906492378, 0.0907221599, 
0.0907951113, 0.0908680922, 0.0909411025, 0.0910141422, 0.0910872115, 0.0911603103, 0.0912334386, 0.0913065965, 
0.0913797840, 0.0914530011, 0.0915262478, 0.0915995242, 0.0916728303, 0.0917461660, 0.0918195315, 0.0918929268, 
0.0919663519, 0.0920398067, 0.0921132914, 0.0921868059, 0.0922603504, 0.0923339247, 0.0924075289, 0.0924811631, 
0.0925548273, 0.0926285215, 0.0927022457, 0.0927759999, 0.0928497842, 0.0929235986, 0.0929974432, 0.0930713179, 
0.0931452227, 0.0932191578, 0.0932931230, 0.0933671185, 0.0934411443, 0.0935152004, 0.0935892868, 0.0936634036, 
0.0937375507, 0.0938117282, 0.0938859361, 0.0939601745, 0.0940344433, 0.0941087427, 0.0941830725, 0.0942574329, 
0.0943318239, 0.0944062455, 0.0944806977, 0.0945551805, 0.0946296940, 0.0947042382, 0.0947788131, 0.0948534188, 
0.0949280552, 0.0950027224, 0.0950774205, 0.0951521494, 0.0952269092, 0.0953016998, 0.0953765214, 0.0954513740, 
0.0955262575, 0.0956011720, 0.0956761176, 0.0957510942, 0.0958261019, 0.0959011407, 0.0959762106, 0.0960513117, 
0.0961264439, 0.0962016074, 0.0962768021, 0.0963520280, 0.0964272853, 0.0965025738, 0.0965778937, 0.0966532450, 
0.0967286276, 0.0968040417, 0.0968794872, 0.0969549641, 0.0970304726, 0.0971060126, 0.0971815841, 0.0972571872, 
0.0973328219, 0.0974084883, 0.0974841863, 0.0975599159, 0.0976356773, 0.0977114704, 0.0977872953, 0.0978631519, 
0.0979390404, 0.0980149607, 0.0980909128, 0.0981668969, 0.0982429129, 0.0983189608, 0.0983950407, 0.0984711526, 
0.0985472965, 0.0986234725, 0.0986996806, 0.0987759207, 0.0988521930, 0.0989284975, 0.0990048341, 0.0990812030, 
0.0991576041, 0.0992340375, 0.0993105032, 0.0993870012, 0.0994635316, 0.0995400943, 0.0996166895, 0.0996933170, 
0.0997699771, 0.0998466696, 0.0999233947, 0.1000001523, 0.1000769424, 0.1001537652, 0.1002306206, 0.1003075087, 
0.1003844294, 0.1004613829, 0.1005383690, 0.1006153880, 0.1006924397, 0.1007695243, 0.1008466417, 0.1009237920, 
0.1010009753, 0.1010781914, 0.1011554405, 0.1012327226, 0.1013100377, 0.1013873859, 0.1014647671, 0.1015421815, 
0.1016196290, 0.1016971096, 0.1017746234, 0.1018521705, 0.1019297508, 0.1020073644, 0.1020850112, 0.1021626914, 
0.1022404050, 0.1023181520, 0.1023959323, 0.1024737461, 0.1025515934, 0.1026294742, 0.1027073886, 0.1027853365, 
0.1028633179, 0.1029413331, 0.1030193818, 0.1030974642, 0.1031755804, 0.1032537303, 0.1033319139, 0.1034101313, 
0.1034883826, 0.1035666677, 0.1036449867, 0.1037233396, 0.1038017265, 0.1038801473, 0.1039586021, 0.1040370909, 
0.1041156138, 0.1041941708, 0.1042727619, 0.1043513872, 0.1044300466, 0.1045087403, 0.1045874682, 0.1046662303, 
0.1047450268, 0.1048238575, 0.1049027227, 0.1049816222, 0.1050605561, 0.1051395245, 0.1052185273, 0.1052975647, 
0.1053766366, 0.1054557431, 0.1055348841, 0.1056140598, 0.1056932702, 0.1057725152, 0.1058517950, 0.1059311095, 
0.1060104587, 0.1060898428, 0.1061692618, 0.1062487156, 0.1063282043, 0.1064077279, 0.1064872865, 0.1065668801, 
0.1066465087, 0.1067261724, 0.1068058712, 0.1068856050, 0.1069653741, 0.1070451783, 0.1071250177, 0.1072048923, 
0.1072848023, 0.1073647475, 0.1074447281, 0.1075247440, 0.1076047953, 0.1076848821, 0.1077650043, 0.1078451620, 
0.1079253553, 0.1080055841, 0.1080858484, 0.1081661484, 0.1082464841, 0.1083268554, 0.1084072624, 0.1084877052, 
0.1085681838, 0.1086486981, 0.1087292484, 0.1088098344, 0.1088904564, 0.1089711143, 0.1090518082, 0.1091325381, 
0.1092133040, 0.1092941060, 0.1093749441, 0.1094558183, 0.1095367286, 0.1096176752, 0.1096986580, 0.1097796770, 
0.1098607324, 0.1099418240, 0.1100229520, 0.1101041165, 0.1101853173, 0.1102665546, 0.1103478283, 0.1104291386, 
0.1105104854, 0.1105918689, 0.1106732889, 0.1107547456, 0.1108362390, 0.1109177691, 0.1109993359, 0.1110809395, 
0.1111625800, 0.1112442573, 0.1113259714, 0.1114077225, 0.1114895106, 0.1115713356, 0.1116531976, 0.1117350967, 
0.1118170329, 0.1118990062, 0.1119810166, 0.1120630642, 0.1121451491, 0.1122272712, 0.1123094306, 0.1123916273, 
0.1124738613, 0.1125561328, 0.1126384416, 0.1127207879, 0.1128031717, 0.1128855931, 0.1129680520, 0.1130505485, 
0.1131330826, 0.1132156543, 0.1132982638, 0.1133809110, 0.1134635960, 0.1135463187, 0.1136290793, 0.1137118778, 
0.1137947141, 0.1138775884, 0.1139605007, 0.1140434510, 0.1141264393, 0.1142094657, 0.1142925302, 0.1143756329, 
0.1144587737, 0.1145419528, 0.1146251701, 0.1147084257, 0.1147917196, 0.1148750519, 0.1149584225, 0.1150418316, 
0.1151252792, 0.1152087653, 0.1152922899, 0.1153758530, 0.1154594548, 0.1155430952, 0.1156267743, 0.1157104921, 
0.1157942487, 0.1158780440, 0.1159618782, 0.1160457512, 0.1161296631, 0.1162136139, 0.1162976038, 0.1163816326, 
0.1164657004, 0.1165498073, 0.1166339534, 0.1167181385, 0.1168023629, 0.1168866265, 0.1169709293, 0.1170552714, 
0.1171396529, 0.1172240737, 0.1173085339, 0.1173930336, 0.1174775728, 0.1175621514, 0.1176467696, 0.1177314274, 
0.1178161248, 0.1179008619, 0.1179856387, 0.1180704552, 0.1181553115, 0.1182402076, 0.1183251436, 0.1184101194, 
0.1184951351, 0.1185801909, 0.1186652866, 0.1187504223, 0.1188355981, 0.1189208141, 0.1190060702, 0.1190913664, 
0.1191767029, 0.1192620797, 0.1193474967, 0.1194329541, 0.1195184519, 0.1196039901, 0.1196895687, 0.1197751879, 
0.1198608475, 0.1199465478, 0.1200322886, 0.1201180701, 0.1202038923, 0.1202897551, 0.1203756588, 0.1204616032, 
0.1205475885, 0.1206336147, 0.1207196818, 0.1208057898, 0.1208919388, 0.1209781289, 0.1210643600, 0.1211506323, 
0.1212369457, 0.1213233003, 0.1214096961, 0.1214961332, 0.1215826116, 0.1216691313, 0.1217556924, 0.1218422950, 
0.1219289390, 0.1220156245, 0.1221023516, 0.1221891203, 0.1222759306, 0.1223627825, 0.1224496762, 0.1225366116, 
0.1226235888, 0.1227106078, 0.1227976686, 0.1228847714, 0.1229719162, 0.1230591029, 0.1231463316, 0.1232336024, 
0.1233209154, 0.1234082704, 0.1234956677, 0.1235831072, 0.1236705890, 0.1237581131, 0.1238456795, 0.1239332883, 
0.1240209396, 0.1241086333, 0.1241963696, 0.1242841484, 0.1243719698, 0.1244598339, 0.1245477406, 0.1246356901, 
0.1247236824, 0.1248117174, 0.1248997953, 0.1249879161, 0.1250760798, 0.1251642865, 0.1252525362, 0.1253408290, 
0.1254291649, 0.1255175439, 0.1256059661, 0.1256944315, 0.1257829402, 0.1258714922, 0.1259600876, 0.1260487264, 
0.1261374086, 0.1262261342, 0.1263149035, 0.1264037162, 0.1264925726, 0.1265814727, 0.1266704164, 0.1267594039, 
0.1268484351, 0.1269375102, 0.1270266292, 0.1271157921, 0.1272049989, 0.1272942497, 0.1273835446, 0.1274728835, 
0.1275622666, 0.1276516938, 0.1277411653, 0.1278306810, 0.1279202411, 0.1280098454, 0.1280994942, 0.1281891874, 
0.1282789251, 0.1283687073, 0.1284585341, 0.1285484054, 0.1286383215, 0.1287282822, 0.1288182877, 0.1289083380, 
0.1289984331, 0.1290885731, 0.1291787580, 0.1292689879, 0.1293592628, 0.1294495828, 0.1295399478, 0.1296303581, 
0.1297208135, 0.1298113141, 0.1299018600, 0.1299924513, 0.1300830879, 0.1301737700, 0.1302644975, 0.1303552705, 
0.1304460891, 0.1305369533, 0.1306278631, 0.1307188187, 0.1308098200, 0.1309008670, 0.1309919599, 0.1310830987, 
0.1311742834, 0.1312655141, 0.1313567908, 0.1314481135, 0.1315394824, 0.1316308974, 0.1317223586, 0.1318138661, 
0.1319054199, 0.1319970200, 0.1320886665, 0.1321803595, 0.1322720989, 0.1323638849, 0.1324557174, 0.1325475966, 
0.1326395224, 0.1327314950, 0.1328235144, 0.1329155805, 0.1330076935, 0.1330998535, 0.1331920604, 0.1332843143, 
0.1333766153, 0.1334689633, 0.1335613585, 0.1336538010, 0.1337462906, 0.1338388276, 0.1339314119, 0.1340240436, 
0.1341167228, 0.1342094494, 0.1343022236, 0.1343950454, 0.1344879148, 0.1345808319, 0.1346737967, 0.1347668093, 
0.1348598697, 0.1349529781, 0.1350461343, 0.1351393386, 0.1352325908, 0.1353258912, 0.1354192397, 0.1355126364, 
0.1356060812, 0.1356995744, 0.1357931159, 0.1358867058, 0.1359803441, 0.1360740309, 0.1361677662, 0.1362615501, 
0.1363553827, 0.1364492639, 0.1365431938, 0.1366371726, 0.1367312001, 0.1368252766, 0.1369194019, 0.1370135763, 
0.1371077997, 0.1372020722, 0.1372963938, 0.1373907646, 0.1374851847, 0.1375796540, 0.1376741727, 0.1377687408, 
0.1378633583, 0.1379580254, 0.1380527420, 0.1381475082, 0.1382423240, 0.1383371896, 0.1384321049, 0.1385270700, 
0.1386220850, 0.1387171499, 0.1388122647, 0.1389074296, 0.1390026446, 0.1390979097, 0.1391932249, 0.1392885904, 
0.1393840062, 0.1394794724, 0.1395749889, 0.1396705558, 0.1397661733, 0.1398618413, 0.1399575599, 0.1400533292, 
0.1401491492, 0.1402450199, 0.1403409415, 0.1404369139, 0.1405329373, 0.1406290116, 0.1407251370, 0.1408213135, 
0.1409175411, 0.1410138199, 0.1411101500, 0.1412065314, 0.1413029641, 0.1413994483, 0.1414959839, 0.1415925711, 
0.1416892098, 0.1417859002, 0.1418826423, 0.1419794361, 0.1420762817, 0.1421731792, 0.1422701286, 0.1423671299, 
0.1424641833, 0.1425612888, 0.1426584464, 0.1427556562, 0.1428529182, 0.1429502326, 0.1430475993, 0.1431450184, 
0.1432424900, 0.1433400142, 0.1434375909, 0.1435352203, 0.1436329023, 0.1437306372, 0.1438284248, 0.1439262653, 
0.1440241588, 0.1441221052, 0.1442201047, 0.1443181573, 0.1444162630, 0.1445144220, 0.1446126342, 0.1447108998, 
0.1448092187, 0.1449075911, 0.1450060170, 0.1451044965, 0.1452030296, 0.1453016164, 0.1454002569, 0.1454989513, 
0.1455976994, 0.1456965015, 0.1457953576, 0.1458942677, 0.1459932319, 0.1460922503, 0.1461913228, 0.1462904497, 
0.1463896308, 0.1464888664, 0.1465881564, 0.1466875009, 0.1467869000, 0.1468863537, 0.1469858621, 0.1470854253, 
0.1471850432, 0.1472847161, 0.1473844439, 0.1474842266, 0.1475840644, 0.1476839574, 0.1477839055, 0.1478839088, 
0.1479839674, 0.1480840814, 0.1481842508, 0.1482844757, 0.1483847562, 0.1484850922, 0.1485854839, 0.1486859313, 
0.1487864345, 0.1488869936, 0.1489876086, 0.1490882795, 0.1491890065, 0.1492897896, 0.1493906289, 0.1494915243, 
0.1495924761, 0.1496934842, 0.1497945487, 0.1498956698, 0.1499968473, 0.1500980814, 0.1501993723, 0.1503007198, 
0.1504021241, 0.1505035853, 0.1506051034, 0.1507066785, 0.1508083107, 0.1509100000, 0.1510117464, 0.1511135501, 
0.1512154111, 0.1513173294, 0.1514193052, 0.1515213385, 0.1516234293, 0.1517255778, 0.1518277840, 0.1519300479, 
0.1520323697, 0.1521347494, 0.1522371870, 0.1523396826, 0.1524422363, 0.1525448482, 0.1526475183, 0.1527502467, 
0.1528530334, 0.1529558785, 0.1530587822, 0.1531617444, 0.1532647652, 0.1533678447, 0.1534709829, 0.1535741799, 
0.1536774359, 0.1537807508, 0.1538841247, 0.1539875577, 0.1540910499, 0.1541946012, 0.1542982119, 0.1544018819, 
0.1545056114, 0.1546094004, 0.1547132489, 0.1548171570, 0.1549211249, 0.1550251525, 0.1551292399, 0.1552333873, 
0.1553375946, 0.1554418620, 0.1555461895, 0.1556505772, 0.1557550251, 0.1558595334, 0.1559641020, 0.1560687311, 
0.1561734208, 0.1562781710, 0.1563829819, 0.1564878536, 0.1565927860, 0.1566977794, 0.1568028337, 0.1569079490, 
0.1570131254, 0.1571183630, 0.1572236619, 0.1573290220, 0.1574344435, 0.1575399265, 0.1576454710, 0.1577510771, 
0.1578567448, 0.1579624743, 0.1580682657, 0.1581741189, 0.1582800340, 0.1583860112, 0.1584920505, 0.1585981519, 
0.1587043156, 0.1588105417, 0.1589168301, 0.1590231810, 0.1591295944, 0.1592360705, 0.1593426092, 0.1594492107, 
0.1595558750, 0.1596626023, 0.1597693925, 0.1598762458, 0.1599831622, 0.1600901418, 0.1601971847, 0.1603042910, 
0.1604114607, 0.1605186939, 0.1606259907, 0.1607333512, 0.1608407753, 0.1609482633, 0.1610558152, 0.1611634311, 
0.1612711109, 0.1613788549, 0.1614866631, 0.1615945356, 0.1617024724, 0.1618104736, 0.1619185393, 0.1620266696, 
0.1621348645, 0.1622431242, 0.1623514487, 0.1624598380, 0.1625682924, 0.1626768117, 0.1627853962, 0.1628940459, 
0.1630027608, 0.1631115411, 0.1632203869, 0.1633292981, 0.1634382750, 0.1635473175, 0.1636564257, 0.1637655998, 
0.1638748398, 0.1639841458, 0.1640935178, 0.1642029560, 0.1643124604, 0.1644220311, 0.1645316682, 0.1646413718, 
0.1647511419, 0.1648609787, 0.1649708821, 0.1650808524, 0.1651908895, 0.1653009936, 0.1654111647, 0.1655214029, 
0.1656317083, 0.1657420810, 0.1658525211, 0.1659630286, 0.1660736036, 0.1661842462, 0.1662949566, 0.1664057347, 
0.1665165806, 0.1666274946, 0.1667384765, 0.1668495265, 0.1669606448, 0.1670718313, 0.1671830861, 0.1672944094, 
0.1674058013, 0.1675172617, 0.1676287909, 0.1677403888, 0.1678520556, 0.1679637913, 0.1680755961, 0.1681874700, 
0.1682994131, 0.1684114255, 0.1685235073, 0.1686356586, 0.1687478794, 0.1688601698, 0.1689725300, 0.1690849599, 
0.1691974598, 0.1693100297, 0.1694226696, 0.1695353797, 0.1696481600, 0.1697610107, 0.1698739318, 0.1699869234, 
0.1700999855, 0.1702131184, 0.1703263221, 0.1704395966, 0.1705529421, 0.1706663586, 0.1707798462, 0.1708934051, 
0.1710070352, 0.1711207368, 0.1712345099, 0.1713483545, 0.1714622708, 0.1715762588, 0.1716903187, 0.1718044506, 
0.1719186545, 0.1720329305, 0.1721472787, 0.1722616992, 0.1723761921, 0.1724907575, 0.1726053955, 0.1727201061, 
0.1728348895, 0.1729497458, 0.1730646750, 0.1731796772, 0.1732947526, 0.1734099012, 0.1735251231, 0.1736404185, 
0.1737557873, 0.1738712298, 0.1739867459, 0.1741023359, 0.1742179997, 0.1743337375, 0.1744495493, 0.1745654354, 
0.1746813957, 0.1747974303, 0.1749135394, 0.1750297231, 0.1751459814, 0.1752623144, 0.1753787223, 0.1754952051, 
0.1756117629, 0.1757283959, 0.1758451041, 0.1759618876, 0.1760787465, 0.1761956809, 0.1763126910, 0.1764297768, 
0.1765469383, 0.1766641758, 0.1767814893, 0.1768988789, 0.1770163446, 0.1771338867, 0.1772515052, 0.1773692002, 
0.1774869718, 0.1776048201, 0.1777227451, 0.1778407471, 0.1779588261, 0.1780769822, 0.1781952155, 0.1783135261, 
0.1784319141, 0.1785503795, 0.1786689226, 0.1787875435, 0.1789062421, 0.1790250186, 0.1791438731, 0.1792628058, 
0.1793818167, 0.1795009059, 0.1796200735, 0.1797393197, 0.1798586444, 0.1799780480, 0.1800975303, 0.1802170916, 
0.1803367320, 0.1804564515, 0.1805762503, 0.1806961284, 0.1808160860, 0.1809361232, 0.1810562400, 0.1811764367, 
0.1812967132, 0.1814170697, 0.1815375064, 0.1816580232, 0.1817786204, 0.1818992980, 0.1820200561, 0.1821408948, 
0.1822618143, 0.1823828147, 0.1825038960, 0.1826250584, 0.1827463020, 0.1828676269, 0.1829890331, 0.1831105209, 
0.1832320903, 0.1833537414, 0.1834754744, 0.1835972893, 0.1837191863, 0.1838411654, 0.1839632268, 0.1840853706, 
0.1842075969, 0.1843299058, 0.1844522975, 0.1845747719, 0.1846973294, 0.1848199699, 0.1849426935, 0.1850655005, 
0.1851883908, 0.1853113647, 0.1854344222, 0.1855575634, 0.1856807885, 0.1858040976, 0.1859274907, 0.1860509680, 
0.1861745297, 0.1862981758, 0.1864219064, 0.1865457217, 0.1866696217, 0.1867936067, 0.1869176767, 0.1870418317, 
0.1871660721, 0.1872903978, 0.1874148089, 0.1875393057, 0.1876638882, 0.1877885565, 0.1879133107, 0.1880381510, 
0.1881630775, 0.1882880904, 0.1884131896, 0.1885383754, 0.1886636478, 0.1887890070, 0.1889144532, 0.1890399863, 
0.1891656066, 0.1892913142, 0.1894171091, 0.1895429916, 0.1896689617, 0.1897950195, 0.1899211653, 0.1900473990, 
0.1901737208, 0.1903001309, 0.1904266294, 0.1905532163, 0.1906798919, 0.1908066562, 0.1909335094, 0.1910604515, 
0.1911874828, 0.1913146033, 0.1914418132, 0.1915691125, 0.1916965015, 0.1918239802, 0.1919515488, 0.1920792074, 
0.1922069561, 0.1923347950, 0.1924627244, 0.1925907442, 0.1927188547, 0.1928470559, 0.1929753480, 0.1931037312, 
0.1932322055, 0.1933607711, 0.1934894280, 0.1936181766, 0.1937470167, 0.1938759487, 0.1940049726, 0.1941340886, 
0.1942632968, 0.1943925973, 0.1945219902, 0.1946514758, 0.1947810540, 0.1949107251, 0.1950404893, 0.1951703465, 
0.1953002970, 0.1954303408, 0.1955604782, 0.1956907093, 0.1958210341, 0.1959514529, 0.1960819657, 0.1962125727, 
0.1963432741, 0.1964740699, 0.1966049604, 0.1967359456, 0.1968670257, 0.1969982007, 0.1971294710, 0.1972608365, 
0.1973922975, 0.1975238541, 0.1976555064, 0.1977872545, 0.1979190986, 0.1980510388, 0.1981830753, 0.1983152083, 
0.1984474377, 0.1985797639, 0.1987121869, 0.1988447069, 0.1989773240, 0.1991100384, 0.1992428502, 0.1993757595, 
0.1995087665, 0.1996418713, 0.1997750742, 0.1999083751, 0.2000417743, 0.2001752720, 0.2003088682, 0.2004425631, 
0.2005763568, 0.2007102496, 0.2008442414, 0.2009783326, 0.2011125232, 0.2012468134, 0.2013812034, 0.2015156932, 
0.2016502830, 0.2017849730, 0.2019197634, 0.2020546542, 0.2021896457, 0.2023247379, 0.2024599311, 0.2025952253, 
0.2027306208, 0.2028661176, 0.2030017160, 0.2031374161, 0.2032732180, 0.2034091219, 0.2035451279, 0.2036812363, 
0.2038174471, 0.2039537605, 0.2040901766, 0.2042266957, 0.2043633179, 0.2045000432, 0.2046368720, 0.2047738043, 
0.2049108403, 0.2050479802, 0.2051852240, 0.2053225721, 0.2054600245, 0.2055975813, 0.2057352428, 0.2058730091, 
0.2060108804, 0.2061488568, 0.2062869385, 0.2064251256, 0.2065634183, 0.2067018168, 0.2068403213, 0.2069789318, 
0.2071176486, 0.2072564718, 0.2073954016, 0.2075344381, 0.2076735815, 0.2078128320, 0.2079521898, 0.2080916550, 
0.2082312277, 0.2083709081, 0.2085106965, 0.2086505930, 0.2087905976, 0.2089307107, 0.2090709324, 0.2092112628, 
0.2093517021, 0.2094922504, 0.2096329081, 0.2097736751, 0.2099145518, 0.2100555382, 0.2101966345, 0.2103378409, 
0.2104791576, 0.2106205848, 0.2107621226, 0.2109037711, 0.2110455307, 0.2111874013, 0.2113293833, 0.2114714768, 
0.2116136819, 0.2117559989, 0.2118984279, 0.2120409691, 0.2121836227, 0.2123263888, 0.2124692676, 0.2126122594, 
0.2127553642, 0.2128985823, 0.2130419138, 0.2131853589, 0.2133289179, 0.2134725908, 0.2136163779, 0.2137602793, 
0.2139042952, 0.2140484259, 0.2141926714, 0.2143370321, 0.2144815080, 0.2146260993, 0.2147708062, 0.2149156290, 
0.2150605678, 0.2152056227, 0.2153507940, 0.2154960819, 0.2156414865, 0.2157870081, 0.2159326467, 0.2160784027, 
0.2162242762, 0.2163702673, 0.2165163764, 0.2166626035, 0.2168089488, 0.2169554127, 0.2171019951, 0.2172486964, 
0.2173955167, 0.2175424563, 0.2176895152, 0.2178366938, 0.2179839922, 0.2181314105, 0.2182789491, 0.2184266080, 
0.2185743876, 0.2187222879, 0.2188703092, 0.2190184517, 0.2191667155, 0.2193151010, 0.2194636082, 0.2196122374, 
0.2197609888, 0.2199098625, 0.2200588588, 0.2202079780, 0.2203572201, 0.2205065853, 0.2206560740, 0.2208056863, 
0.2209554224, 0.2211052824, 0.2212552667, 0.2214053754, 0.2215556088, 0.2217059669, 0.2218564501, 0.2220070586, 
0.2221577925, 0.2223086520, 0.2224596375, 0.2226107490, 0.2227619868, 0.2229133511, 0.2230648422, 0.2232164601, 
0.2233682052, 0.2235200777, 0.2236720777, 0.2238242056, 0.2239764614, 0.2241288454, 0.2242813579, 0.2244339990, 
0.2245867690, 0.2247396681, 0.2248926964, 0.2250458543, 0.2251991419, 0.2253525595, 0.2255061073, 0.2256597855, 
0.2258135943, 0.2259675339, 0.2261216046, 0.2262758066, 0.2264301401, 0.2265846054, 0.2267392026, 0.2268939320, 
0.2270487938, 0.2272037883, 0.2273589156, 0.2275141761, 0.2276695699, 0.2278250972, 0.2279807583, 0.2281365534, 
0.2282924828, 0.2284485467, 0.2286047452, 0.2287610788, 0.2289175475, 0.2290741516, 0.2292308913, 0.2293877669, 
0.2295447787, 0.2297019268, 0.2298592115, 0.2300166330, 0.2301741916, 0.2303318875, 0.2304897210, 0.2306476922, 
0.2308058015, 0.2309640490, 0.2311224350, 0.2312809598, 0.2314396236, 0.2315984266, 0.2317573691, 0.2319164514, 
0.2320756736, 0.2322350360, 0.2323945389, 0.2325541825, 0.2327139671, 0.2328738929, 0.2330339602, 0.2331941692, 
0.2333545201, 0.2335150133, 0.2336756489, 0.2338364273, 0.2339973486, 0.2341584132, 0.2343196213, 0.2344809731, 
0.2346424689, 0.2348041089, 0.2349658935, 0.2351278229, 0.2352898972, 0.2354521169, 0.2356144821, 0.2357769932, 
0.2359396503, 0.2361024538, 0.2362654038, 0.2364285008, 0.2365917448, 0.2367551363, 0.2369186754, 0.2370823625, 
0.2372461977, 0.2374101815, 0.2375743139, 0.2377385954, 0.2379030262, 0.2380676065, 0.2382323366, 0.2383972168, 
0.2385622474, 0.2387274287, 0.2388927608, 0.2390582442, 0.2392238790, 0.2393896656, 0.2395556042, 0.2397216951, 
0.2398879386, 0.2400543350, 0.2402208845, 0.2403875874, 0.2405544441, 0.2407214547, 0.2408886197, 0.2410559392, 
0.2412234135, 0.2413910430, 0.2415588280, 0.2417267686, 0.2418948653, 0.2420631182, 0.2422315278, 0.2424000942, 
0.2425688178, 0.2427376988, 0.2429067376, 0.2430759345, 0.2432452897, 0.2434148036, 0.2435844764, 0.2437543084, 
0.2439243000, 0.2440944514, 0.2442647630, 0.2444352350, 0.2446058678, 0.2447766616, 0.2449476168, 0.2451187336, 
0.2452900124, 0.2454614535, 0.2456330571, 0.2458048237, 0.2459767534, 0.2461488466, 0.2463211037, 0.2464935249, 
0.2466661106, 0.2468388610, 0.2470117764, 0.2471848573, 0.2473581039, 0.2475315165, 0.2477050954, 0.2478788410, 
0.2480527536, 0.2482268335, 0.2484010810, 0.2485754965, 0.2487500802, 0.2489248326, 0.2490997538, 0.2492748444, 
0.2494501044, 0.2496255345, 0.2498011347, 0.2499769055, 0.2501528472, 0.2503289602, 0.2505052447, 0.2506817011, 
0.2508583297, 0.2510351309, 0.2512121051, 0.2513892525, 0.2515665734, 0.2517440683, 0.2519217375, 0.2520995813, 
0.2522776000, 0.2524557940, 0.2526341637, 0.2528127094, 0.2529914314, 0.2531703302, 0.2533494059, 0.2535286591, 
0.2537080899, 0.2538876989, 0.2540674864, 0.2542474526, 0.2544275980, 0.2546079229, 0.2547884277, 0.2549691127, 
0.2551499783, 0.2553310249, 0.2555122528, 0.2556936624, 0.2558752540, 0.2560570280, 0.2562389848, 0.2564211248, 
0.2566034483, 0.2567859556, 0.2569686472, 0.2571515235, 0.2573345847, 0.2575178314, 0.2577012638, 0.2578848823, 
0.2580686873, 0.2582526792, 0.2584368584, 0.2586212252, 0.2588057801, 0.2589905234, 0.2591754555, 0.2593605768, 
0.2595458876, 0.2597313884, 0.2599170796, 0.2601029615, 0.2602890346, 0.2604752992, 0.2606617557, 0.2608484045, 
0.2610352461, 0.2612222808, 0.2614095090, 0.2615969311, 0.2617845475, 0.2619723587, 0.2621603650, 0.2623485668, 
0.2625369646, 0.2627255587, 0.2629143495, 0.2631033376, 0.2632925232, 0.2634819068, 0.2636714889, 0.2638612697, 
0.2640512498, 0.2642414296, 0.2644318094, 0.2646223898, 0.2648131711, 0.2650041537, 0.2651953382, 0.2653867248, 
0.2655783140, 0.2657701063, 0.2659621022, 0.2661543019, 0.2663467060, 0.2665393149, 0.2667321290, 0.2669251488, 
0.2671183747, 0.2673118071, 0.2675054466, 0.2676992934, 0.2678933482, 0.2680876112, 0.2682820831, 0.2684767642, 
0.2686716549, 0.2688667558, 0.2690620672, 0.2692575897, 0.2694533236, 0.2696492696, 0.2698454279, 0.2700417991, 
0.2702383836, 0.2704351819, 0.2706321945, 0.2708294218, 0.2710268643, 0.2712245225, 0.2714223968, 0.2716204877, 
0.2718187957, 0.2720173212, 0.2722160649, 0.2724150270, 0.2726142081, 0.2728136087, 0.2730132293, 0.2732130703, 
0.2734131323, 0.2736134157, 0.2738139210, 0.2740146487, 0.2742155994, 0.2744167734, 0.2746181714, 0.2748197937, 
0.2750216410, 0.2752237136, 0.2754260122, 0.2756285371, 0.2758312890, 0.2760342683, 0.2762374756, 0.2764409112, 
0.2766445759, 0.2768484701, 0.2770525942, 0.2772569489, 0.2774615346, 0.2776663518, 0.2778714012, 0.2780766831, 
0.2782821983, 0.2784879470, 0.2786939300, 0.2789001478, 0.2791066007, 0.2793132896, 0.2795202147, 0.2797273768, 
0.2799347763, 0.2801424137, 0.2803502897, 0.2805584048, 0.2807667595, 0.2809753544, 0.2811841900, 0.2813932669, 
0.2816025856, 0.2818121468, 0.2820219509, 0.2822319985, 0.2824422903, 0.2826528267, 0.2828636084, 0.2830746359, 
0.2832859097, 0.2834974305, 0.2837091989, 0.2839212153, 0.2841334805, 0.2843459950, 0.2845587593, 0.2847717741, 
0.2849850399, 0.2851985573, 0.2854123271, 0.2856263496, 0.2858406256, 0.2860551556, 0.2862699402, 0.2864849801, 
0.2867002758, 0.2869158280, 0.2871316372, 0.2873477042, 0.2875640294, 0.2877806135, 0.2879974572, 0.2882145611, 
0.2884319257, 0.2886495517, 0.2888674398, 0.2890855906, 0.2893040047, 0.2895226827, 0.2897416253, 0.2899608331, 
0.2901803068, 0.2904000470, 0.2906200543, 0.2908403295, 0.2910608732, 0.2912816859, 0.2915027685, 0.2917241214, 
0.2919457455, 0.2921676413, 0.2923898096, 0.2926122510, 0.2928349661, 0.2930579557, 0.2932812205, 0.2935047610, 
0.2937285780, 0.2939526722, 0.2941770442, 0.2944016948, 0.2946266247, 0.2948518345, 0.2950773249, 0.2953030966, 
0.2955291504, 0.2957554869, 0.2959821069, 0.2962090111, 0.2964362001, 0.2966636747, 0.2968914356, 0.2971194836, 
0.2973478193, 0.2975764435, 0.2978053569, 0.2980345603, 0.2982640544, 0.2984938398, 0.2987239175, 0.2989542880, 
0.2991849522, 0.2994159108, 0.2996471645, 0.2998787142, 0.3001105605, 0.3003427043, 0.3005751462, 0.3008078872, 
0.3010409278, 0.3012742689, 0.3015079114, 0.3017418559, 0.3019761032, 0.3022106541, 0.3024455095, 0.3026806701, 
0.3029161366, 0.3031519100, 0.3033879910, 0.3036243803, 0.3038610789, 0.3040980875, 0.3043354069, 0.3045730380, 
0.3048109815, 0.3050492384, 0.3052878093, 0.3055266952, 0.3057658969, 0.3060054151, 0.3062452509, 0.3064854049, 
0.3067258781, 0.3069666712, 0.3072077852, 0.3074492209, 0.3076909792, 0.3079330609, 0.3081754669, 0.3084181980, 
0.3086612552, 0.3089046393, 0.3091483511, 0.3093923917, 0.3096367618, 0.3098814623, 0.3101264942, 0.3103718584, 
0.3106175557, 0.3108635870, 0.3111099534, 0.3113566556, 0.3116036945, 0.3118510713, 0.3120987866, 0.3123468415, 
0.3125952369, 0.3128439738, 0.3130930530, 0.3133424756, 0.3135922424, 0.3138423544, 0.3140928127, 0.3143436180, 
0.3145947715, 0.3148462740, 0.3150981266, 0.3153503301, 0.3156028857, 0.3158557942, 0.3161090567, 0.3163626742, 
0.3166166476, 0.3168709780, 0.3171256664, 0.3173807137, 0.3176361209, 0.3178918892, 0.3181480195, 0.3184045129, 
0.3186613703, 0.3189185929, 0.3191761816, 0.3194341375, 0.3196924616, 0.3199511551, 0.3202102189, 0.3204696541, 
0.3207294618, 0.3209896431, 0.3212501990, 0.3215111306, 0.3217724390, 0.3220341252, 0.3222961905, 0.3225586359, 
0.3228214624, 0.3230846712, 0.3233482634, 0.3236122402, 0.3238766026, 0.3241413518, 0.3244064889, 0.3246720150, 
0.3249379314, 0.3252042390, 0.3254709392, 0.3257380330, 0.3260055217, 0.3262734063, 0.3265416881, 0.3268103682, 
0.3270794479, 0.3273489282, 0.3276188105, 0.3278890959, 0.3281597856, 0.3284308809, 0.3287023828, 0.3289742928, 
0.3292466119, 0.3295193415, 0.3297924827, 0.3300660369, 0.3303400052, 0.3306143889, 0.3308891893, 0.3311644077, 
0.3314400452, 0.3317161033, 0.3319925832, 0.3322694861, 0.3325468134, 0.3328245664, 0.3331027464, 0.3333813547, 
0.3336603925, 0.3339398614, 0.3342197625, 0.3345000972, 0.3347808669, 0.3350620729, 0.3353437166, 0.3356257994, 
0.3359083225, 0.3361912874, 0.3364746955, 0.3367585482, 0.3370428468, 0.3373275928, 0.3376127875, 0.3378984325, 
0.3381845290, 0.3384710786, 0.3387580827, 0.3390455427, 0.3393334601, 0.3396218363, 0.3399106728, 0.3401999711, 
0.3404897326, 0.3407799589, 0.3410706514, 0.3413618116, 0.3416534410, 0.3419455412, 0.3422381137, 0.3425311600, 
0.3428246816, 0.3431186801, 0.3434131570, 0.3437081139, 0.3440035524, 0.3442994741, 0.3445958804, 0.3448927731, 
0.3451901536, 0.3454880237, 0.3457863849, 0.3460852389, 0.3463845872, 0.3466844316, 0.3469847736, 0.3472856150, 
0.3475869573, 0.3478888023, 0.3481911517, 0.3484940070, 0.3487973701, 0.3491012426, 0.3494056262, 0.3497105228, 
0.3500159339, 0.3503218613, 0.3506283068, 0.3509352722, 0.3512427591, 0.3515507695, 0.3518593050, 0.3521683675, 
0.3524779587, 0.3527880805, 0.3530987347, 0.3534099232, 0.3537216477, 0.3540339101, 0.3543467123, 0.3546600562, 
0.3549739436, 0.3552883764, 0.3556033565, 0.3559188858, 0.3562349663, 0.3565515999, 0.3568687885, 0.3571865340, 
0.3575048384, 0.3578237038, 0.3581431320, 0.3584631251, 0.3587836850, 0.3591048138, 0.3594265135, 0.3597487861, 
0.3600716337, 0.3603950584, 0.3607190621, 0.3610436470, 0.3613688152, 0.3616945687, 0.3620209097, 0.3623478403, 
0.3626753626, 0.3630034788, 0.3633321910, 0.3636615015, 0.3639914123, 0.3643219257, 0.3646530439, 0.3649847690, 
0.3653171034, 0.3656500493, 0.3659836089, 0.3663177845, 0.3666525784, 0.3669879928, 0.3673240301, 0.3676606926, 
0.3679979826, 0.3683359025, 0.3686744546, 0.3690136412, 0.3693534649, 0.3696939279, 0.3700350327, 0.3703767816, 
0.3707191773, 0.3710622220, 0.3714059183, 0.3717502686, 0.3720952754, 0.3724409413, 0.3727872687, 0.3731342603, 
0.3734819185, 0.3738302459, 0.3741792451, 0.3745289187, 0.3748792693, 0.3752302996, 0.3755820121, 0.3759344095, 
0.3762874946, 0.3766412699, 0.3769957383, 0.3773509023, 0.3777067649, 0.3780633286, 0.3784205963, 0.3787785708, 
0.3791372548, 0.3794966512, 0.3798567628, 0.3802175925, 0.3805791432, 0.3809414176, 0.3813044188, 0.3816681497, 
0.3820326131, 0.3823978121, 0.3827637496, 0.3831304286, 0.3834978522, 0.3838660233, 0.3842349450, 0.3846046204, 
0.3849750525, 0.3853462445, 0.3857181995, 0.3860909206, 0.3864644110, 0.3868386738, 0.3872137124, 0.3875895298, 
0.3879661294, 0.3883435144, 0.3887216881, 0.3891006537, 0.3894804147, 0.3898609743, 0.3902423360, 0.3906245030, 
0.3910074789, 0.3913912670, 0.3917758708, 0.3921612939, 0.3925475395, 0.3929346114, 0.3933225130, 0.3937112479, 
0.3941008198, 0.3944912321, 0.3948824885, 0.3952745927, 0.3956675485, 0.3960613593, 0.3964560292, 0.3968515616, 
0.3972479605, 0.3976452297, 0.3980433730, 0.3984423941, 0.3988422971, 0.3992430859, 0.3996447642, 0.4000473362, 
0.4004508058, 0.4008551770, 0.4012604539, 0.4016666404, 0.4020737408, 0.4024817591, 0.4028906994, 0.4033005660, 
0.4037113631, 0.4041230949, 0.4045357656, 0.4049493796, 0.4053639411, 0.4057794546, 0.4061959244, 0.4066133548, 
0.4070317505, 0.4074511158, 0.4078714552, 0.4082927732, 0.4087150746, 0.4091383637, 0.4095626454, 0.4099879241, 
0.4104142047, 0.4108414919, 0.4112697904, 0.4116991051, 0.4121294407, 0.4125608021, 0.4129931942, 0.4134266221, 
0.4138610906, 0.4142966047, 0.4147331695, 0.4151707901, 0.4156094716, 0.4160492192, 0.4164900380, 0.4169319333, 
0.4173749104, 0.4178189745, 0.4182641310, 0.4187103853, 0.4191577429, 0.4196062091, 0.4200557895, 0.4205064897, 
0.4209583153, 0.4214112718, 0.4218653650, 0.4223206005, 0.4227769842, 0.4232345218, 0.4236932192, 0.4241530823, 
0.4246141171, 0.4250763294, 0.4255397254, 0.4260043111, 0.4264700927, 0.4269370762, 0.4274052680, 0.4278746744, 
0.4283453015, 0.4288171558, 0.4292902438, 0.4297645718, 0.4302401464, 0.4307169742, 0.4311950617, 0.4316744157, 
0.4321550429, 0.4326369501, 0.4331201441, 0.4336046317, 0.4340904200, 0.4345775160, 0.4350659266, 0.4355556591, 
0.4360467205, 0.4365391182, 0.4370328594, 0.4375279515, 0.4380244018, 0.4385222179, 0.4390214073, 0.4395219775, 
0.4400239363, 0.4405272914, 0.4410320506, 0.4415382216, 0.4420458125, 0.4425548312, 0.4430652858, 0.4435771844, 
0.4440905352, 0.4446053465, 0.4451216265, 0.4456393838, 0.4461586267, 0.4466793638, 0.4472016038, 0.4477253554, 
0.4482506272, 0.4487774283, 0.4493057675, 0.4498356537, 0.4503670962, 0.4509001041, 0.4514346865, 0.4519708530, 
0.4525086127, 0.4530479754, 0.4535889505, 0.4541315477, 0.4546757768, 0.4552216476, 0.4557691700, 0.4563183542, 
0.4568692101, 0.4574217480, 0.4579759783, 0.4585319112, 0.4590895574, 0.4596489273, 0.4602100318, 0.4607728815, 
0.4613374874, 0.4619038604, 0.4624720117, 0.4630419524, 0.4636136939, 0.4641872476, 0.4647626250, 0.4653398377, 
0.4659188975, 0.4664998162, 0.4670826059, 0.4676672786, 0.4682538464, 0.4688423219, 0.4694327173, 0.4700250453, 
0.4706193185, 0.4712155498, 0.4718137521, 0.4724139385, 0.4730161222, 0.4736203165, 0.4742265350, 0.4748347911, 
0.4754450987, 0.4760574717, 0.4766719240, 0.4772884698, 0.4779071235, 0.4785278996, 0.4791508125, 0.4797758772, 
0.4804031084, 0.4810325213, 0.4816641312, 0.4822979533, 0.4829340033, 0.4835722969, 0.4842128499, 0.4848556784, 
0.4855007986, 0.4861482270, 0.4867979800, 0.4874500745, 0.4881045275, 0.4887613559, 0.4894205771, 0.4900822087, 
0.4907462683, 0.4914127738, 0.4920817433, 0.4927531950, 0.4934271475, 0.4941036194, 0.4947826297, 0.4954641975, 
0.4961483421, 0.4968350831, 0.4975244403, 0.4982164336, 0.4989110833, 0.4996084100, 0.5003084342, 0.5010111769, 
0.5017166594, 0.5024249031, 0.5031359297, 0.5038497612, 0.5045664197, 0.5052859277, 0.5060083080, 0.5067335837, 
0.5074617780, 0.5081929145, 0.5089270170, 0.5096641098, 0.5104042173, 0.5111473643, 0.5118935758, 0.5126428772, 
0.5133952943, 0.5141508529, 0.5149095795, 0.5156715008, 0.5164366437, 0.5172050357, 0.5179767044, 0.5187516779, 
0.5195299846, 0.5203116534, 0.5210967133, 0.5218851940, 0.5226771254, 0.5234725378, 0.5242714620, 0.5250739291, 
0.5258799707, 0.5266896187, 0.5275029056, 0.5283198643, 0.5291405280, 0.5299649305, 0.5307931060, 0.5316250892, 
0.5324609153, 0.5333006200, 0.5341442394, 0.5349918102, 0.5358433696, 0.5366989553, 0.5375586055, 0.5384223591, 
0.5392902554, 0.5401623344, 0.5410386365, 0.5419192029, 0.5428040752, 0.5436932959, 0.5445869077, 0.5454849544, 
0.5463874801, 0.5472945298, 0.5482061490, 0.5491223841, 0.5500432819, 0.5509688903, 0.5518992575, 0.5528344329, 
0.5537744664, 0.5547194086, 0.5556693113, 0.5566242266, 0.5575842078, 0.5585493089, 0.5595195849, 0.5604950915, 
0.5614758854, 0.5624620243, 0.5634535667, 0.5644505721, 0.5654531012, 0.5664612154, 0.5674749774, 0.5684944507, 
0.5695197001, 0.5705507914, 0.5715877915, 0.5726307687, 0.5736797921, 0.5747349323, 0.5757962611, 0.5768638514, 
0.5779377776, 0.5790181153, 0.5801049416, 0.5811983349, 0.5822983750, 0.5834051432, 0.5845187223, 0.5856391966, 
0.5867666522, 0.5879011765, 0.5890428588, 0.5901917898, 0.5913480623, 0.5925117707, 0.5936830113, 0.5948618821, 
0.5960484833, 0.5972429169, 0.5984452870, 0.5996556998, 0.6008742636, 0.6021010888, 0.6033362884, 0.6045799774, 
0.6058322733, 0.6070932960, 0.6083631682, 0.6096420147, 0.6109299635, 0.6122271449, 0.6135336923, 0.6148497420, 
0.6161754332, 0.6175109081, 0.6188563123, 0.6202117946, 0.6215775070, 0.6229536051, 0.6243402482, 0.6257375990, 
0.6271458243, 0.6285650946, 0.6299955845, 0.6314374729, 0.6328909428, 0.6343561819, 0.6358333822, 0.6373227407, 
0.6388244591, 0.6403387444, 0.6418658086, 0.6434058693, 0.6449591495, 0.6465258782, 0.6481062903, 0.6497006269, 
0.6513091355, 0.6529320705, 0.6545696928, 0.6562222708, 0.6578900802, 0.6595734043, 0.6612725345, 0.6629877704, 
0.6647194203, 0.6664678014, 0.6682332401, 0.6700160726, 0.6718166450, 0.6736353139, 0.6754724468, 0.6773284224, 
0.6792036312, 0.6810984761, 0.6830133727, 0.6849487498, 0.6869050503, 0.6888827315, 0.6908822661, 0.6929041422, 
0.6949488649, 0.6970169564, 0.6991089570, 0.7012254259, 0.7033669425, 0.7055341065, 0.7077275398, 0.7099478871, 
0.7121958171, 0.7144720236, 0.7167772272, 0.7191121762, 0.7214776482, 0.7238744519, 0.7263034284, 0.7287654533, 
0.7312614381, 0.7337923330, 0.7363591283, 0.7389628572, 0.7416045980, 0.7442854772, 0.7470066718, 0.7497694131, 
0.7525749892, 0.7554247494, 0.7583201077, 0.7612625471, 0.7642536240, 0.7672949735, 0.7703883143, 0.7735354551, 
0.7767383004, 0.7799988577, 0.7833192451, 0.7867016993, 0.7901485851, 0.7936624049, 0.7972458098, 0.8009016116, 
0.8046327961, 0.8084425375, 0.8123342151, 0.8163114309, 0.8203780298, 0.8245381218, 0.8287961073, 0.8331567047, 
0.8376249819, 0.8422063921, 0.8469068131, 0.8517325933, 0.8566906030, 0.8617882932, 0.8670337629, 0.8724358367, 
0.8780041540, 0.8837492726, 0.8896827889, 0.8958174792, 0.9021674653, 0.9087484099, 0.9155777500, 0.9226749747, 
0.9300619609, 0.9377633800, 0.9458071946, 0.9542252722, 0.9630541468, 0.9723359779, 0.9821197679, 0.9924629277, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
};

struct synth::adsr2_t::impl_t: piw::cfilterctl_t, piw::cfilter_t
{
    impl_t(const piw::cookie_t &o, piw::clockdomain_ctl_t *d) : cfilter_t(this,o,d) {}
    piw::cfilterfunc_t *cfilterctl_create(const piw::data_t &);
    unsigned long long cfilterctl_thru() { return THRU_MASK; }
    unsigned long long cfilterctl_inputs() { return IN_MASK; }
    unsigned long long cfilterctl_outputs() { return OUT_MASK; }
};

namespace
{
    struct phase_t
    {
        phase_t();

        void setup_flat(unsigned long samplerate);
        void setup_skip();
        void setup_linear(unsigned long samplerate, int sgn, float mn, float mx, float fullscale);
        void setup_damping(unsigned long samplerate, float mn, unsigned long max_ms);
        void setup_exp(unsigned long samplerate, float mn);

        bool (*process)(phase_t *,float,float *,float);
        unsigned long ms;
        unsigned long samples;
        float min;
        float max;
        float inc;
        float full;
        float a,b,c;
    };

    struct adsr2func_t: piw::cfilterfunc_t
    {
        adsr2func_t(synth::adsr2_t::impl_t *ctl) : current_(0), phase_(P_OFF),  count_(0), residual_(0), last_output_(0), keyon_(false), residual_fade_(0), ctl_(ctl)
        {
            phases_[P_DELAY].ms = DEFAULT_DELAY_TIME;
            phases_[P_ATTACK].ms = DEFAULT_ATTACK_TIME;
            phases_[P_HOLD].ms = DEFAULT_HOLD_TIME;
            phases_[P_DECAY].ms = DEFAULT_DECAY_TIME;
            phases_[P_SUSTAIN].ms = ~0UL;
            phases_[P_RELEASE].ms = DEFAULT_RELEASE_TIME;
            phases_[P_OFF].ms = ~0UL;
            sustain_ = __vel2amplitude(DEFAULT_SUSTAIN);
            current_atten_ = 0;
            aftertouch_ = false;
            pedal_ = false;
        }

        void process(float *out, unsigned i, unsigned to, const float *pressure_in)
        {
            if(aftertouch_)
            {
                if(pressure_in)
                {
                    for(; i < to; ++i)
                    {
                        process_sample();
                        //float p = __vel2amplitude(piw::denormalise(1.f,0.f,0.f,pa[i]));
                        float p = piw::denormalise(1.f,0.f,0.f,pressure_in[i]);
                        last_output_=current_*p+residual_*fadecurve__[residual_fade_];
                        out[i] = piw::normalise(1.f,0.f,0.f,last_output_);
                        if(residual_fade_<127) residual_fade_++;
                        //if(phase_==P_RELEASE) pic::logmsg() << "w1 " << (void *)this << ' ' << last_output_ << ' ' << p;
                    }
                }
                else
                {
                    //float p = aftertouch_ ? __vel2amplitude(current_pressure_) : 1;
                    float p = current_pressure_;
                    for(; i < to; ++i)
                    {
                        process_sample();
                        last_output_=current_*p+residual_*fadecurve__[residual_fade_];
                        out[i] = piw::normalise(1.f,0.f,0.f,last_output_);
                        if(residual_fade_<127) residual_fade_++;
                        //if(phase_==P_RELEASE) pic::logmsg() << "w2 " << (void *)this << ' ' << last_output_ << ' ' << p;
                    }
                }
            }
            else
            {
                for(; i < to; ++i)
                {
                    process_sample();
                    last_output_=current_+residual_*fadecurve__[residual_fade_];
                    out[i] = piw::normalise(1.f,0.f,0.f,last_output_);
                    if(residual_fade_<127) residual_fade_++;
                    //if(phase_==P_RELEASE) pic::logmsg() << "w3 " << last_output_;
                }
            }
        }

        void release()
        {
            if(phase_>=P_RELEASE)
                return;

            phase_ = P_RELEASE;
            count_ = 0;
        }

        void keyon(piw::cfilterenv_t *env,float v,unsigned long long t)
        {
            //pic::logmsg() << (void *)this << " envelope activating at " << t;
            keyon_ = true;
            phase_ = P_DELAY;
            setup_envelope(env,v);
            count_ = 0;
            env->cfilterenv_output(OUT_ACTIVATION,piw::makebool_nb(true,t));
        }

        void keyoff(unsigned long long t)
        {
            //pic::logmsg() << (void *)this << " keyoff at " << t;
            keyon_ = false;
            if(pedal_)
            {   
                //pic::logmsg() << "pedal engaged, not releasing";
                return;
            }

            //pic::logmsg() << (void *) this << " " << "envelope releasing";
            release();
        }

        inline void ensure_output(unsigned long long t, unsigned bs, float **out, float **fs, bct_data_t *o)
        {
            if(*out && *fs && *o) return;
            *o = piw::makearray_nb(t,1,0,0,bs,out,fs).give();
            memset(*out,0,bs*sizeof(float));
        }

        bool cfilterfunc_process(piw::cfilterenv_t *env, unsigned long long f, unsigned long long t, unsigned long sr, unsigned bs)
        {
            unsigned sig;
            piw::data_nb_t d;

            float *out = 0;
            float *fs = 0;
            bct_data_t o = 0;

            const float *pressure_in = 0;
            if(env->cfilterenv_nextsig(IN_PRESSURE,d,t))
            {
                filter_pressure(d);
                pressure_in = d.as_array();
            }

            //pic::logmsg() << "adsr2 tick ph:" << phase_ << " t:" << f << "-" << t << " cur:" << current_;

            unsigned samp_from = 0;
            unsigned samp_to = 0;
            bool active = false;

            while(env->cfilterenv_next(sig,d,t))
            {
                //pic::logmsg() << "adsr2 input sig:" << sig << " data:" << d << ' ' << d.time();
                samp_to = sample_offset(bs,d.time(),f,t);

                if(samp_to>samp_from)
                {
                    //pic::logmsg() << "samp to=" << samp_to << " samp_from=" << samp_from;
                    ensure_output(t, bs, &out, &fs, &o);

                    process(out,samp_from,samp_to,pressure_in);
                    samp_from = samp_to;
                }
                //else pic::logmsg() << "*** samp to=" << samp_to << " samp_from=" << samp_from;

                switch(sig)
                {
                    case 0:
                        keyoff(d.time());
                        active = true;
                        break;

                    case IN_VELOCITY:
                        filter_velocity(d);
                        active = true;
                        break;

                    case IN_DELAY:
                        filter_time(P_DELAY,d);
                        active = true;
                        break;

                    case IN_ATTACK:
                        filter_time(P_ATTACK,d);
                        active = true;
                        break;

                    case IN_HOLD:
                        filter_time(P_HOLD,d);
                        active = true;
                        break;

                    case IN_DECAY:
                        filter_time(P_DECAY,d,1.0);
                        active = true;
                        break;

                    case IN_SUSTAIN:
                        filter_sustain(d);
                        active = true;
                        break;

                    case IN_RELEASE:
                        filter_time(P_RELEASE,d,1);
                        active = true;
                        break;

                    case IN_ATTEN:
                        filter_atten(d);
                        active = true;
                        break;

                    case IN_AFTERTOUCH:
                        filter_aftertouch(d);
                        active = true;
                        break;

                    case IN_PEDAL:
                        filter_pedal(d);
                        active = true;
                        break;

                    case IN_ACTIVATION:
                        //pic::logmsg() << "activation =" << d << " at " << samp_from;
                        filter_activation(env,d);
                        active = true;
                        break;

                    case IN_DAMPER:
                        filter_damper(d);
                        break;
                }

            }

            if(act_ && !active && phase_==P_OFF)
            {
                last_output_=0;
                env->cfilterenv_output(OUT_ACTIVATION,piw::makebool_nb(false,t));
                return false;
            }

            ensure_output(t, bs, &out, &fs, &o);

            process(out,samp_from,bs,pressure_in);

            *fs=out[bs-1];
            env->cfilterenv_output(OUT_AMPLITUDE,piw::data_nb_t::from_given(o));
            return true;
        }

        phase_t *advance()
        {
            //pic::logmsg() << (void *) this << " " << "phase " << phase_ << " ended at count " << count_ << " current=" << current_;
            phase_ = std::min(P_OFF,phase_+1);
            count_ = 0;
            //pic::logmsg() << (void *) this << " new phase " << phase_ << " inc=" << phases_[phase_].inc << " duration " << phases_[phase_].samples;
            return &phases_[phase_];
        }

        void process_sample()
        {
            if(phase_==P_OFF)
                return;

            phase_t *p = &phases_[phase_];

            while(count_ > p->samples)
            {
                //pic::logmsg() << "leaving ph " << phase_ << " duration=" << p->samples;
                advance();
                p = &phases_[phase_];
            }

            float val;
            bool done = p->process(p,current_,&val,damper_);
            current_=val;

            if(done)
            {
                //pic::logmsg() << "leaving ph " << phase_ << " val=" << val << " duration=" << p->samples;
                advance();
            }

            ++count_;
        }

        void setup_envelope(piw::cfilterenv_t *e, float vel)
        {
            unsigned long sr = e->cfilterenv_clock()->get_sample_rate();

            float ca=1;

            if(current_atten_!=0)
            {
                ca =  __vel2amplitude(vel);
            }

            phases_[P_DELAY].setup_flat(sr);
            phases_[P_ATTACK].setup_linear(sr,1,-1,ca,ca);
            phases_[P_HOLD].setup_flat(sr);
            phases_[P_DECAY].setup_exp(sr,sustain_*ca);
            phases_[P_SUSTAIN].setup_flat(sr);
            phases_[P_RELEASE].setup_damping(sr,0,phases_[P_DECAY].ms);
            phases_[P_OFF].setup_flat(sr);

            //pic::logmsg() << (void *) this << " envelope starting" << " current=" << current_ << " ca=" << ca << " delay=" << phases_[P_DELAY].ms << " ms/" << phases_[P_DELAY].samples << " samples" << " attack=" << phases_[P_ATTACK].ms << " ms/" << phases_[P_ATTACK].samples << " samples" << " hold=" << phases_[P_HOLD].ms << " ms/" << phases_[P_HOLD].samples << " samples" << " decay=" << phases_[P_DECAY].ms << " ms/" << phases_[P_DECAY].samples << " samples" << " sustain=" << sustain_ << " release=" << phases_[P_RELEASE].ms << " ms/" << phases_[P_RELEASE].samples << " samples" << " damper " << damper_;
        }

        void filter_time(unsigned p, const piw::data_nb_t &value,float min=0.0)
        {
            float ms = 1000.0*value.as_renorm_float(BCTUNIT_SECONDS,0,60,0); 
            if(ms<min) ms=min;
            phases_[p].ms = (unsigned long)ms;
        }

        void filter_sustain(const piw::data_nb_t &value)
        {
            float s = value.as_renorm(0,1,0);
            sustain_ = (s>0)?__val2amplitude(s):0; 
        }

        void filter_pressure(const piw::data_nb_t &value)
        {
            current_pressure_ = value.as_renorm(0,1,0); 
        }

        void filter_atten(const piw::data_nb_t &value)
        {
            current_atten_ = value.as_renorm(0,1,0); 
        }

        void filter_aftertouch(const piw::data_nb_t &value)
        {
            aftertouch_ = (value.as_renorm(0,1,0)!=0); 
        }

        void filter_pedal(const piw::data_nb_t &value)
        {
            bool op = pedal_;
            pedal_ = (value.as_arraylen()!=0 && value.as_renorm(0,1,0)>0.5);

            if(pedal_!=op)
            {
                if(!pedal_ && !keyon_)
                {
                    release();
                }
            }
        }

        void filter_damper(const piw::data_nb_t &value)
        {
            damper_ = value.as_renorm(0,1,0);
        }

        void filter_activation(piw::cfilterenv_t *env,const piw::data_nb_t &value)
        {
            bool act = (value.as_norm()>0.0);
            if(act!=act_)
            {
                if(!act_)
                {
                    act_=act;
                }

                if(act)
                {
                    keyon(env,velocity_,value.time());
                }
            }
        }

        void filter_velocity(const piw::data_nb_t &value)
        {
            velocity_=value.as_renorm(0,1,0);
        }

        bool cfilterfunc_end(piw::cfilterenv_t *e, unsigned long long t)
        {
            //pic::logmsg() << "adsr2 linger " << (void *)this << ' ' << act_ << ' ' << last_output_;
            return act_;
        }

        bool cfilterfunc_start(piw::cfilterenv_t *env, const piw::data_nb_t &id)
        {
            //pic::logmsg() << "adsr2 prime " << (void *)this << " " << id.time() << " residual " << residual_ << " current " << current_ << ' ' << phase_; env->cfilterenv_dump(false);
            residual_ = last_output_;
            residual_fade_ = 0;
            act_=false;

            current_=0;
            phases_[P_DELAY].ms = DEFAULT_DELAY_TIME;
            phases_[P_ATTACK].ms = DEFAULT_ATTACK_TIME;
            phases_[P_HOLD].ms = DEFAULT_HOLD_TIME;
            phases_[P_DECAY].ms = DEFAULT_DECAY_TIME;
            phases_[P_SUSTAIN].ms = ~0UL;
            phases_[P_RELEASE].ms = DEFAULT_RELEASE_TIME;
            phases_[P_OFF].ms = ~0UL;
            sustain_ = __vel2amplitude(DEFAULT_SUSTAIN);
            current_atten_ = 0;
            aftertouch_ = false;
            pedal_ = false;
            current_pressure_ = 0;
            damper_ = 0;
            velocity_ = 0;

            piw::data_nb_t d;
            unsigned long long t=id.time();

            if(env->cfilterenv_latest(IN_VELOCITY,d,t))
            {
                filter_velocity(d);
            }
            else
            {
                return false;
            }

            if(env->cfilterenv_latest(IN_DELAY,d,t))      filter_time(P_DELAY,d);
            if(env->cfilterenv_latest(IN_ATTACK,d,t))     filter_time(P_ATTACK,d);
            if(env->cfilterenv_latest(IN_HOLD,d,t))       filter_time(P_HOLD,d);
            if(env->cfilterenv_latest(IN_DECAY,d,t))      filter_time(P_DECAY,d,1.0);
            if(env->cfilterenv_latest(IN_SUSTAIN,d,t))    filter_sustain(d);
            if(env->cfilterenv_latest(IN_RELEASE,d,t))    filter_time(P_RELEASE,d,1.0);
            if(env->cfilterenv_latest(IN_ATTEN,d,t))      filter_atten(d);
            if(env->cfilterenv_latest(IN_AFTERTOUCH,d,t)) filter_aftertouch(d);
            if(env->cfilterenv_latest(IN_PEDAL,d,t))      filter_pedal(d);
            if(env->cfilterenv_latest(IN_DAMPER,d,t))     filter_damper(d);

            env->cfilterenv_reset(IN_ACTIVATION,t);
            env->cfilterenv_reset(IN_PRESSURE,t);

            return true;
        }

        float __val2amplitude(float val)
        {
            return pic::interp(val*AMPLITUDE_RANGE_CB,val2amp_table__,AMPLITUDE_TABLE_SIZE);
        }

        float __vel2amplitude(float vel)
        {
            //static const float fact = -20.f/(96.f*logf(10.f));
            //float v = 1.f-vel;
            //return fact*pic::approx::ln(v*v);
            return pic::interp(vel*VEL2AMP_RANGE,vel2amp_table__,VEL2AMP_TABLE_SIZE);
        }

        float sustain_;
        float current_;
        unsigned phase_;
        phase_t phases_[P_NUM];
        volatile unsigned count_;
        float current_pressure_;
        float current_atten_;
        bool aftertouch_;
        bool pedal_;
        float damper_;
        float residual_;
        float last_output_;
        bool keyon_;
        unsigned residual_fade_;
        float velocity_;
        bool act_;
        synth::adsr2_t::impl_t *ctl_;
    };
}

piw::cfilterfunc_t *synth::adsr2_t::impl_t::cfilterctl_create(const piw::data_t &) { return new adsr2func_t(this); }
synth::adsr2_t::adsr2_t(const piw::cookie_t &o, piw::clockdomain_ctl_t *d) : impl_(new impl_t(o,d)) {}
piw::cookie_t synth::adsr2_t::cookie() { return impl_->cookie(); }
synth::adsr2_t::~adsr2_t() { delete impl_; }

static bool process_linear(phase_t *p, float in, float *out, float damp)
{
    *out = in+p->inc;
    return (*out<=p->min || *out>=p->max);
}

void phase_t::setup_linear(unsigned long samplerate, int sgn, float min_, float max_, float fullscale)
{
    if(ms)
    {
        samples = (ms!=~0UL) ? (ms*samplerate)/1000UL : ~0UL;
    }
    else
    {
        samples = 1;
    }

    full = fullscale;
    min = min_;
    max = max_;

    process = process_linear;
    inc = (samples != 0) ? sgn*(1.0f/samples) : 0.0;
    inc *= fullscale;

    //pic::logmsg() << "setup linear ms=" << ms << " inc=" << inc << " fs=" << fullscale << " sr=" << samplerate;
}

static bool process_unbounded_damp(phase_t *p, float in, float *out, float damp)
{
    if(damp<=0.0)
    {
        *out=in;
    }
    else
    {
        float tc = p->a+(p->b/damp);
        float inc = 1.0-(1.0/tc);
        *out = p->min+inc*(in-p->min);
    }

    return (*out-p->min)<=OFF_THRESHOLD;
}

static bool process_bounded_damp(phase_t *p, float in, float *out, float damp)
{
    float tc = p->a+(p->b/(damp+p->c));
    float inc = 1.0-(1.0/tc);

    *out = p->min+inc*(in-p->min);
    if((*out-p->min)<=OFF_THRESHOLD)
    {
        //pic::logmsg() << "bounded damp " << *out << " " << p->min << " " << (*out-p->min);
        return true;
    }

    return false;
}

static bool process_exp(phase_t *p, float in, float *out, float damp)
{
    float tc = p->a;
    float inc = 1.0-(1.0/tc);

    *out = p->min+inc*(in-p->min);
    return (*out-p->min)<=OFF_THRESHOLD;
}

void phase_t::setup_exp(unsigned long samplerate,  float mn)
{
    samples = (ms!=~0UL) ? (ms*samplerate)/1000UL : ~0UL;
    min = mn;
    process = process_exp;

    a = ms*samplerate/8000ULL;

    //pic::logmsg() << "setup decay tc=" << tcr << " ms=" << ms << " a=" << a << " b=" << b << " nd=" << normaldamp;
}

void phase_t::setup_damping(unsigned long samplerate,  float mn, unsigned long max_ms)
{
    samples = ~0UL;
    min = mn;

    float min_tc = MIN_RELEASE*samplerate/(1000ULL*FULL_RELEASE_TCS);
    float rel_tc = ms*samplerate/(1000ULL*FULL_RELEASE_TCS);

    if(rel_tc<min_tc*2)
    {
        rel_tc=min_tc*2;
    }

    if(max_ms>ms)
    {
        float max_tc = max_ms*samplerate/(1000ULL*FULL_RELEASE_TCS);

        process = process_bounded_damp;
        a=(-2.0*max_tc*min_tc+(max_tc+min_tc)*rel_tc)/(-max_tc-min_tc+2.0*rel_tc);
        b=(-max_tc*max_tc*min_tc+max_tc*min_tc*min_tc+(max_tc*max_tc-min_tc*min_tc)*rel_tc+(min_tc-max_tc)*rel_tc*rel_tc)/(max_tc*max_tc+2.0*max_tc*min_tc+min_tc*min_tc+(-4.0*max_tc-4.0*min_tc)*rel_tc+4.0*rel_tc*rel_tc);
        c=(min_tc-rel_tc)/(-max_tc-min_tc+2.0*rel_tc);

        //pic::logmsg() << "setup bounded decay rel_tc=" << rel_tc << " max_tc=" << max_tc << " ms=" << ms << " a=" << a << " b=" << b << " c=" << c;
    }
    else
    {
        process = process_unbounded_damp;
        a=2.0*min_tc-rel_tc;
        b=rel_tc-min_tc;

        //pic::logmsg() << "setup unbounded decay rel_tc=" << rel_tc << " ms=" << ms << " a=" << a << " b=" << b;
    }

}

static bool process_flat(phase_t *p, float in, float *out, float damp)
{
    *out = in;
    return (in<=OFF_THRESHOLD);
}

void phase_t::setup_flat(unsigned long samplerate)
{
    samples = (ms!=~0UL) ? (ms*samplerate)/1000UL : ~0UL;
    process = process_flat;
}

void phase_t::setup_skip()
{
    samples = 0;
    process = process_flat;
}

phase_t::phase_t(): process(process_flat),ms(0),samples(0),min(0),max(0),inc(0)
{
}

